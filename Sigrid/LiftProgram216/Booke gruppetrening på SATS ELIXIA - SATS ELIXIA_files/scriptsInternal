function getBrowserInfo(){var i=navigator.userAgent,t,n=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):n[1]==="Chrome"&&(t=i.match(/\bOPR\/(\d+)/),t!=null)?{name:"Opera",version:t[1]}:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&n.splice(1,1,t[1]),{name:n[0],version:n[1]})}function setupOldIeAlert(){var n=readCookie("doNotShowOldBrowserWarning");haveOldIE()&&!n&&(showOldIeAlert(),createCookie("doNotShowOldBrowserWarning","true",1))}function haveOldIE(){var n=getBrowserInfo(),t=parseInt(n.version);return(n.name=="IE"||n.name=="MSIE")&&t<=9?!0:!1}function showOldIeAlert(){$("#oldIeAlert").modal()}function createCookie(n,t,i){var u,r;i?(r=new Date,r.setTime(r.getTime()+i*864e5),u="; expires="+r.toGMTString()):u="";document.cookie=n+"="+t+u+"; path=/"}function readCookie(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null}function checkBrowserBreakpointSize(){var u=["xs","sm","md","lg"],i=window.document,n=i.createElement("div"),t,r;for(i.body.appendChild(n),t=u.length-1;t>=0;t--)if(r=u[t],n.className="hidden-"+r,n.offsetParent===null)return i.body.removeChild(n),r;return""}function setEmbededInAppCookie(){var n=readCookie("EmbededInAppCookie");n||createCookie("EmbededInAppCookie","true")}function isEmbededInApp(){return getUrlParameter("mobile")==="1"||readCookie("EmbededInAppCookie")==="true"?!0:!1}function getCtmName(){var n;return typeof waitForGa=="undefined"&&(waitForGa=function(t){if(t==undefined&&(t=0),t<20)try{t=t+1;n=ga.getAll()[0].get("name");(typeof n=="undefined"||n=="undefined"||n=="")&&setTimeout(function(){waitForGa(t)},150)}catch(i){setTimeout(function(){waitForGa(t)},150)}}),(typeof n=="undefined"||n=="undefined"||n=="")&&waitForGa(),n}function parseDate(n){var t=n.substring(0,4),i=n.substring(4,6),r=n.substring(6,8);return new Date(t+"-"+i+"-"+r)}function InfoBox(n){n=n||{};google.maps.OverlayView.apply(this,arguments);this.content_=n.content||"";this.disableAutoPan_=n.disableAutoPan||!1;this.maxWidth_=n.maxWidth||0;this.pixelOffset_=n.pixelOffset||new google.maps.Size(0,0);this.position_=n.position||new google.maps.LatLng(0,0);this.zIndex_=n.zIndex||null;this.boxClass_=n.boxClass||"infoBox";this.boxStyle_=n.boxStyle||{};this.closeBoxMargin_=n.closeBoxMargin||"2px";this.closeBoxURL_=n.closeBoxURL||"http://www.google.com/intl/en_us/mapfiles/close.gif";n.closeBoxURL===""&&(this.closeBoxURL_="");this.infoBoxClearance_=n.infoBoxClearance||new google.maps.Size(1,1);typeof n.visible=="undefined"&&(n.visible=typeof n.isHidden=="undefined"?!0:!n.isHidden);this.isHidden_=!n.visible;this.alignBottom_=n.alignBottom||!1;this.pane_=n.pane||"floatPane";this.enableEventPropagation_=n.enableEventPropagation||!1;this.div_=null;this.closeListener_=null;this.moveListener_=null;this.contextListener_=null;this.eventListeners_=null;this.fixedWidthSet_=null}function pushMenu(n){var t=$(".cookie-notice"),i=$(".drawer-menu"),r=$(".navbar-fixed-top"),u=$("body");n?(i.css("top",t.outerHeight()+"px"),r.css("top",t.outerHeight()+"px"),u.css("margin-top",t.height()+"px")):(i.css("top","0"),r.css("top","0"),u.css("margin-top",0))}var getUrlParameter=function(n){for(var u=decodeURIComponent(window.location.search.substring(1)),r=u.split("&"),t,i=0;i<r.length;i++)if(t=r[i].split("="),t[0]===n)return t[1]===undefined?!0:t[1];return null},loginModule=angular.module("SatsElixia.Login",["app.api"]),breadcrums,center,instructors,satsElixia,mainController,app,myPtClipsApp,sats;loginModule.controller("loginModalController",["$scope","$modalInstance","loginApi","ngNotify",function(n,t,i,r){var u=this;u.facebookLoginUrl=satsSettings.facebookLoginUrl;u.googleLoginUrl=satsSettings.googleLoginUrl;u.cancel=function(){t.dismiss("cancel")};n.performLogin=function(u,f,e){n.isPerformingLogin=!0;i.performLogin(u,f,e).then(function(n){function i(n){return n==="Couldn't validate username or password"&&(n=satsSettings.loginCredentialsError),n}n.data.LoginSuccess===!0?(ga("set","userId",n.userId),t.close("finished")):(n.data.StatusMessage=i(n.data.StatusMessage),n.data.StatusMessage||(n.data.StatusMessage=satsSettings.generalError),r.set(n.data.StatusMessage,"error"))},function(){r.set(satsSettings.generalError,"error")}).finally(function(){n.isPerformingLogin=!1})};n.resetPassword=function(n){i.resetPassword(n).then(function(){r.set(satsSettings.resetPasswordSuccess,"success")}).catch(function(){r.set(satsSettings.resetPasswordFailed,"error")})}}]);loginModule.controller("loginController",["$scope","$modal","querystring",function(n,t,i){var r=i.returnUrl,u=i.socialMediaLogin;n.openLoginModal=function(){var i=t.open({animation:!0,templateUrl:satsSettings.basePath+"NgTemplates/loginModal",controller:"loginModalController",size:"md",controllerAs:"vm",scope:n});i.result.then(function(n){n=="finished"&&(r?window.location=r:window.location.reload())})};(u||r)&&(n.isSocialMediaLogin=u!=null,n.openLoginModal())}]);loginModule.directive("stopEvent",function(){return{restrict:"A",link:function(n,t,i){t.on(i.stopEvent,function(n){n.stopPropagation()})}}});breadcrums=angular.module("SatsElixia.Breadcrums",[]);breadcrums.controller("breadcrumsController",[function(){}]);center=angular.module("SatsElixia.Center",["app.api"]).service("centerService",["$rootScope","filtersApi","ngNotify",function(n,t,i){var r=this;r.data=null;r.filter=0;r.region=0;this.filterCenters=function(u){r.filters=u;t.getCentersForFilter(u,r.region).then(function(t){r.data=t.data.Regions;n.$broadcast("filtered:centers",r.data)},function(){i.set(satsSettings.generalError,"error")})}}]).controller("centersFilterController",["$scope","centerService","filtersApi",function(n,t,i){n.initWithRegionAndFilters=function(r,u){t.region=r;i.getCenterFilters(u).then(function(i){n.filters=i.data;t.filterCenters(0)})};n.handleFilterClick=function(i){n.selectedFilter=n.selectedFilter==i?0:i;t.filterCenters(n.selectedFilter)};n.isSelectedFilter=function(t){return n.selectedFilter==t}}]).controller("centersMapOrListController",["$scope","$rootScope","$modal","centerService",function(n,t,i,r){n.setShow=function(t){n.showMap=t=="map"};n.zoomCenter=function(i){n.showMap=!0;t.zoomCenterId=i};n.clickCenterName=function(t,u,f){n.center=_.chain(r.data).pluck("Centers").flatten().findWhere({Id:t}).value();n.showContactInformation=u;n.overridePhoneNumber=f;i.open({animation:!0,templateUrl:satsSettings.basePath+"scripts/mapInfoWindow.html",size:"md",controller:"centerInfoModalController",controllerAs:"vm",scope:n})}}]).controller("centerInfoModalController",["$modalStack","$scope",function(n,t){var i=this,r={name:t.center.Name,latitude:t.center.Position.Latitude,longitude:t.center.Position.Longitude,openingHours:t.center.OpeningHours,imageUrl:t.center.TeaserImageUrl,phone:t.overridePhoneNumber?t.overridePhoneNumber:t.center.Phone,address:t.center.Address,url:t.center.Url,showContactInformation:t.showContactInformation};t.parameter={model:r};i.cancel=function(){n.dismissAll()}}]).controller("centerMapController",["$scope","$rootScope","$http","uiGmapGoogleMapApi","centerService",function(n,t,i,r,u){n.init=function(t,i,r,u){n.centerId=t;n.showContactInformation=i;n.overridePhoneNumber=r;n.mapZoom=u};r.then(function(){t.zoomCenterId&&(n.centerId=t.zoomCenterId,n.showInfoBox=!0,t.zoomCenterId=null);n.map={center:{latitude:satsSettings.countryLocation.latitude,longitude:satsSettings.countryLocation.longitude},zoom:n.mapZoom,options:{scrollwheel:!1,disableDefaultUI:!0,zoomControl:!0,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#e6e6e2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"},{gamma:"1"},{weight:"1"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#333333"},{visibility:"on"}]}],mapTypeId:google.maps.MapTypeId.ROADMAP},window:{markers:[],show:!1,options:{boxClass:"infobox",maxWidth:300,pixelOffset:new google.maps.Size(-145,-60),alignBottom:!0,closeBoxURL:"",infoBoxClearance:new google.maps.Size(1,1)}},clusterOptions:{averageCenter:!0,styles:[{anchorText:[-4,0],anchorIcon:[37,14],textSize:"14",fontFamily:"proxima-nova, Helvetica, Arial, sans-serif",fontWeight:"bold",textColor:"white",url:satsSettings.basePath+"images/sats-pin-cluster.svg",width:32,height:42}]},markerEvents:{click:function(t,i,r){r.id==n.map.window.model.id?n.map.window.model.show=!n.map.window.model.show:(r.show=!1,n.map.window.model=r,n.map.window.model.show=!0)}},events:{zoom_changed:function(){angular.forEach(n.map.window.markers,function(n){n.show=!1})}}};(checkBrowserBreakpointSize()==="xs"||checkBrowserBreakpointSize()==="sm")&&(n.map.zoom=5);n.$on("filtered:centers",function(t,i){n.updateMap(i)});u.data===null?u.filterCenters(0):n.updateMap(u.data)});n.updateMap=function(t){if(n.regions=t,n.map.window.markers=[],angular.forEach(n.regions,function(t,i){angular.forEach(t.Centers,function(t,r){if(t.Position.Latitude!==null&&(!n.centerId||t.Id==n.centerId)){var f=getBrowserInfo(),u={id:i+"-"+r,name:t.Name,latitude:t.Position.Latitude,longitude:t.Position.Longitude,openingHours:t.OpeningHours,imageUrl:t.TeaserImageUrl,phone:n.overridePhoneNumber?n.overridePhoneNumber:t.Phone,address:t.Address,url:t.Url,show:!1,icon:{url:satsSettings.basePath+"Images/marker.png",size:new google.maps.Size(32,42)},showContactInformation:n.showContactInformation};f.name==="IE"&&f.version==="11"&&(u.icon.url=satsSettings.basePath+"Images/marker.png");u.showCenterText=satsSettings.showCenterText;n.map.window.markers.push(u)}})}),n.map.window.model=n.map.window.markers[0]||{},n.map.window.markers.length==1){var i={longitude:n.map.window.model.longitude,latitude:n.map.window.model.latitude};n.map.center=i;n.map.zoom=15}n.map.window.model.show=n.showInfoBox;n.showInfoBox=!1}}]).controller("centerListController",["$scope","centerService",function(n,t){n.$on("filtered:centers",function(t,i){n.regions=i});t.data===null?t.filterCenters(0):n.regions=t.data}]).controller("centerController",["_","$q","$rootScope","$scope","classesApi","bookingDataService","ngNotify","$http","endpoint",function(n,t,i,r,u,f,e,o,s){function a(n){var t=n;return h?(angular.forEach(h.data.classTypes,function(i){n.classTypeId==i.id&&(t.imageUrl=i.imageUrl,t.description=i.description,t.profile=i.profile,t.videoUrl=i.videoUrl)}),t):null}function v(){i.$on("bookings updated",function(){l(f.bookings)});c().then(function(){l(f.bookings)})}function l(t){n.each(r.classes,function(i){var r=n.find(t,function(n){return i.id==n.class.id});r?(i.isBooking=!0,i.booking=r,i.bookingId=r.id):i.isBooking=!1})}var h,c;r.isLoggedIn=f.isLoggedIn;r.setCenterId=function(n){r.centerId=n;v()};o.get(s+"/classtypes").then(function(n){h=n},function(){e.set("Failed to get class types","error")});r.moments=[satsSettings.timeOfDay.morning,satsSettings.timeOfDay.prenoon,satsSettings.timeOfDay.afternoon,satsSettings.timeOfDay.evening];r.getClasses=function(t,i){return n.filter(r.classes,function(n){return n.moment===t&&n.weekday===i?a(n):null})};r.dateDelta=0;r.activeWeekdays=[];r.dates=[];c=function(n){var o=t.defer(),i,e,f,s;for(n&&(r.dateDelta=r.dateDelta+n),r.activeWeekdays=[],r.dates=[],r.datesToShow=[],i=0+r.dateDelta;i<4+r.dateDelta;i++)e=moment().add(i,"days"),r.dates.push(e.format("YYYYMMDD")),r.activeWeekdays.push(e.weekday()),f=new Date,f.setDate(f.getDate()+i),r.datesToShow.push(f);return s={centers:[r.centerId],dates:r.dates},u.searchClasses(s).then(function(n){angular.forEach(n.data.classes,function(n){var i=moment(n.startTime).format("HH:mm"),t="1970-01-01 "+i;n.moment=moment(t).isBefore("1970-01-01 11:30")?satsSettings.timeOfDay.morning:moment(t).isBetween("1970-01-01 11:29","1970-01-01 13:00")?satsSettings.timeOfDay.prenoon:moment(t).isBetween("1970-01-01 12:59","1970-01-01 17:31")?satsSettings.timeOfDay.afternoon:satsSettings.timeOfDay.evening;n.startTimeString=i;n.weekday=moment(n.startTime).weekday();n.isBooking=!1;n.isBookable=moment().isBefore(moment(n.startTime))});r.classes=n.data.classes;o.resolve()}),o.promise};r.stepInTime=function(n){var t=4,i=checkBrowserBreakpointSize();i==="sm"?t=2:i==="xs"?t=1:i==="md"&&(t=3);n==="backwards"&&(t=0-t);c(t)};r.isToday=function(n){var i=!1,t=new Date;return n.getDate()==t.getDate()&&n.getYear()==t.getYear()&&n.getMonth()==t.getMonth()&&(i=!0),i};r.isTomorrow=function(n){var i=!1,t=new Date;return n.getDate()==t.getDate()+1&&n.getYear()==t.getYear()&&n.getMonth()==t.getMonth()&&(i=!0),i};r.getWeekDayName=function(n){return moment(n).format("dddd")};r.logInAndBookClass=function(n){r.isLoggedIn=!0;r.createBooking(n.id).then(function(){setTimeout(function(){window.location.reload()},400)})};r.createBooking=function(n){return r.beingChanged=n,f.createBooking(n).then(function(){e.set(satsSettings.booking.bookingSuccessful,"success")},function(n){var t=f.humanizeApiError(n.data);e.set(t||satsSettings.booking.bookingFailed,{type:"error",sticky:!0,duration:1e4});bookingClass=null}).finally(function(){r.beingChanged=null})};r.cancelBooking=function(n){return r.classToCancel=n,r.beingChanged=n.id,f.cancelBooking(n.bookingId).then(function(){r.classToCancel.booking.positionInQueue--;r.classToCancel=null;e.set(satsSettings.booking.cancelBookingSuccessful,"success")},function(){e.set(satsSettings.booking.cancelBookingFailed,"error")}).finally(function(){r.beingChanged=null})}}]),function(){"use strict";var n=angular.module("SatsElixia.Grid",["app.api","ngSanitize"]).directive("stopEvent",function(){return{restrict:"A",link:function(n,t,i){i&&i.stopEvent&&t.bind(i.stopEvent,function(n){n.stopPropagation()})}}}).service("gridService",function(){this.getGridClass=function(n,t){var i="col-xs-12 col-sm-12 col-md-6 col-lg-6",r="col-xs-12 col-sm-6 col-lg-3 col-md-3";if(t==4)return i;switch(n%6){case 0:return i;case 1:return t-n==1?i:r;case 2:return r;case 3:return t-n==1||t-n==2?i:r;case 4:return t-n==1?i:r;case 5:return i;default:return i}}}).controller("productGridController",["filtersApi","selectedArticlesApi","$scope","gridService","$modal",function(n,t,i,r){i.btnClicked=!1;i.filtersShowing=!1;i.allItemsLoaded=!1;i.goToPage=function(n,t){t.stopPropagation();window.location.href=n};i.goToBookingPage=function(n,t,i){i.stopPropagation();var r=n+"?classTypes="+t;window.location.href=r};i.getGridClass=function(n,t){return r.getGridClass(n,t)};i.toggleButtonLabel=function(n,t){var r=$("#toggleButtonLabel")[0],u=$(".caret")[0];i.filtersShowing?(r.innerText=n,$(".caret").css("border-bottom","none"),$(".caret").css("border-top","4px dashed")):(r.innerText=t,$(".caret").css("border-top","none"),$(".caret").css("border-bottom","4px dashed"));i.filtersShowing=!i.filtersShowing};i.filters=[];i.products=[];i.selectedFilter=0;i.init=function(r,u){i.filterContainerId=r;u==0?(n.getProductFilters(i.filterContainerId).then(function(n){i.filters=n.data}),i.getProductsForSelectedFilter()):t.getSelectedArticles(u).then(function(n){i.allProducts=n.data;i.currentProducts=i.allProducts.slice(0,9);i.index=i.currentProducts.length;i.allItemsLoaded=i.allProducts.length===i.currentProducts.length})};i.handleFilterClick=function(n){i.selectedFilter=i.selectedFilter==n?0:n;i.getProductsForSelectedFilter()};i.isSelectedFilter=function(n){return i.selectedFilter==n};i.getProductsForSelectedFilter=function(){n.getProductsForFilter(i.filterContainerId,i.selectedFilter).then(function(n){i.allProducts=n.data;i.currentProducts=i.allProducts.slice(0,9);i.index=i.currentProducts.length;i.allItemsLoaded=i.allProducts.length===i.currentProducts.length})};i.loadMoreItems=function(){var n=i.allProducts.slice(i.index,i.index+5);i.currentProducts=i.currentProducts.concat(n);i.index=i.currentProducts.length;i.allItemsLoaded=i.allProducts.length===i.currentProducts.length}}]);n.controller("newsGridController",["$scope","$http",function(n,t){n.init=function(i,r,u){i?(n.filterContainerId=i,n.getFilters(n.filterContainerId).then(function(t){n.filters=t.data;n.selectedFilter=0;n.getNewsForSelectedFilter()})):(r||u)&&(r=r?r:0,u=u?u:0,t.get(satsSettings.basePath+"webapi/news/"+satsSettings.country+"/"+r+"/"+u).success(function(t){n.newsItems=t}))};n.getFilters=function(n){return t.get(satsSettings.basePath+"webapi/news/filters/"+satsSettings.country+"/"+n)};n.isSelectedFilter=function(t){return n.selectedFilter==t};n.handleFilterClick=function(t){n.selectedFilter=n.selectedFilter==t?0:t;n.getNewsForSelectedFilter()};n.getNewsForSelectedFilter=function(){t.get(satsSettings.basePath+"webapi/filterednews/"+satsSettings.country+"/"+n.filterContainerId+"/"+n.selectedFilter).success(function(t){n.newsItems=t})}}])}();instructors=angular.module("sats.instructors",["app.api"]);instructors.controller("instructorsController",["$scope","$http","ngNotify",function(n,t,i){n.getInstructors=function(r){t.get(satsSettings.basePath+"webapi/instructors/"+r).then(function(t){n.allInstructors=t.data;n.currentInstructors=n.allInstructors.slice(0,8);n.index=n.currentInstructors.length;n.allItemsLoaded=n.allInstructors.length===n.currentInstructors.length},function(){i.set(satsSettings.booking.getInstructorsFailed,"error")})};n.loadMoreItems=function(){n.currentInstructors=n.allInstructors;n.allItemsLoaded=n.allInstructors.length===n.currentInstructors.length}}]);satsElixia=angular.module("SatsElixia",["uiGmapgoogle-maps","app.booking","app.booking-listing","SatsElixia.Login","SatsElixia.Center","SatsElixia.Breadcrums","SatsElixia.Grid","SatsElixia.PowerBar","SatsElixia.myPtCLipsApp","angular.filter","ui.bootstrap","SatsElixia.Search","SatsElixia.XForm","headroom","sats.cookie-notice","sats.video-modal","sats.instructors","sats.carousel","sats.sticky-footer"]);mainController=satsElixia.controller("mainController",["$scope","$modal",function(n){isEmbededInApp()&&(n.isEmbededInApp=!0)}]);angular.module("SatsElixia.PowerBar",["app.api","ui.bootstrap"]).controller("powerBarController",["_","recommendationsApi","centersApi","bookingDataService","$scope","$rootScope","$q","$location","ngNotify",function(n,t,i,r,u,f,e,o,s){function w(){var n=window.navigator.userLanguage||window.navigator.language;moment.locale(n);l();f.$on("bookings updated",function(){c(r.bookings);u.selectedDate&&(u.selectedDateData=u.getCardData(u.selectedDate),u.selectedDateData[0].data.length==0&&u.selectedDateData[1].data.length==0&&u.selectDate(u.selectedDate))});b().then(function(){a();c(r.bookings)})}function c(t){n.each(u.days,function(n){n.bookings=[]});y(t)}function b(){var t=e.defer();return i.getCenters().then(function(i){n.each(i.data.regions,function(t){n.each(t.centers,function(n){h[n.filterId]=n})});t.resolve()}),t.promise}var h;u.isDateSelected=!1;u.classBeingChanged=null;u.selectedDate=null;u.days={};h=[];u.setBookingPageUrl=function(n){u.bookingPageUrl=n};u.hasBookings=function(n){return n.bookings.length>0};u.generateStartTime=function(n){return moment(n.dateTime).format("HH:mm")};u.generateTitle=function(n,t){var r="sv",i;return satsSettings.country&&(r=satsSettings.country),moment.locale(r),moment().isSame(moment(n),"day")?satsSettings.today:moment().add(1,"d").isSame(moment(n),"day")?satsSettings.tomorrow:(t?i=moment(n).format("DD MMM"):(i=moment(n).format("DD MMMM"),r==="fi"&&(i=i+"ta")),i)};u.isBookingPage=function(n){return n===window.location.pathname};u.formatTime=function(n){return moment(n).format("HH:mm")};u.getQueueNumber=function(n){return n.positionInQueue?n.positionInQueue:n.waitingListCount>0&&!n.isBooking?n.waitingListCount:null};u.selectDate=function(n){u.selectedDate==n?(u.isDateSelected=!1,u.selectedDate=null):(u.selectedDateData=u.getCardData(n),u.bookQueryDate=moment(n).format("YYYYMMDD"),u.selectedDateData[0].data.length>0||u.selectedDateData[1].data.length>0?(u.isDateSelected=!0,u.selectedDate=n):window.location=u.bookingPageUrl+"?dates="+u.bookQueryDate)};u.getCardData=function(t){var r=u.days[t],i=[{type:"bookings",data:[]},{type:"recommendations",data:[]}],e,f;return Array.prototype.push.apply(i[0].data,n.first(r.bookings,3)),r.recommendations!==undefined&&(e=3-i[0].data.length,n.each(r.recommendations,function(t){var u=n.find(r.bookings,function(n){return n.classId===t.classId});!u&&e>0&&(i[1].data.push(t),e--)})),f=function(n){angular.forEach(i,function(t){angular.forEach(t.data,function(t){t.dateTime=moment.tz(t.dateTime,n)})})},satsSettings.country=="fi"?f("Europe/Helsinki"):satsSettings.country=="sv"?f("Europe/Stockholm"):satsSettings.country=="no"&&f("Europe/Oslo"),i};u.bookClass=function(n){u.classBeingChanged===null&&(u.classBeingChanged=n,r.createBooking(n.classId).then(function(){s.set(satsSettings.booking.bookingSuccessful,"success");u.classBeingChanged=null},function(n){var t=r.humanizeApiError(n.data);s.set(t||satsSettings.booking.bookingFailed,{type:"error",sticky:!0,duration:1e4});u.classBeingChanged=null}))};u.beingBooked=function(n){return u.classBeingChanged===null||u.classBeingChanged===undefined||u.classBeingChanged===""?!1:u.classBeingChanged.classId===n.classId};u.beingChanged=function(n){return u.classBeingChanged===null||u.classBeingChanged===undefined||u.classBeingChanged===""?!1:u.classBeingChanged.bookingId===n.bookingId};u.cancelBooking=function(n){u.classBeingChanged===null&&(u.classBeingChanged=n,r.cancelBooking(n.bookingId).then(function(){s.set(satsSettings.booking.cancelBookingSuccessful,"success");u.classBeingChanged=null},function(n){var t=r.humanizeApiError(n.data);s.set(t||satsSettings.booking.cancelBookingFailed,{type:"error",sticky:!0,duration:1e4});u.classBeingChanged=null}))};var l=function(){var n,t;for(u.days={},n=0;n<5;n++)t=moment().add(n,"d").format("YYYY-MM-DD"),u.days[t]={bookings:[]}},a=function(){var n=moment().format("YYYY-MM-DD"),i=moment().add(4,"d").format("YYYY-MM-DD");t.getRecommendationsForDate(n,i).then(v)},v=function(n){var i=p(n.data.classes),t,r;if(i.length>0)for(t=0;t<i.length;t++)r=moment(i[t].dateTime).format("YYYY-MM-DD"),u.days[r].recommendations||(u.days[r].recommendations=[]),u.days[r].recommendations.push(i[t])},y=function(n){if(!n)return{};var t=n.map(function(n){return{classId:n.class.id,instructor:n.class.instructorId,duration:n.class.durationInMinutes,name:n.class.name,dateTime:n.class.startTime,bookingId:n.id,center:h[n.class.centerFilterId],waitingListCount:n.class.waitingListCount,positionInQueue:n.positionInQueue,isBooking:!0}});angular.forEach(t,function(n){var i=moment(n.dateTime).format("YYYY-MM-DD"),t;u.days[i]!==undefined&&(t=function(t){n.dateTime=moment.tz(n.dateTime,t)},satsSettings.country=="fi"?t("Europe/Helsinki"):satsSettings.country=="sv"?t("Europe/Stockholm"):satsSettings.country=="no"&&t("Europe/Oslo"),u.days[i].bookings.push(n))})},p=function(n){if(!n)return{};return n.map(function(n){return{center:h[n.centerFilterId],instructor:n.instructorId,name:n.name,dateTime:n.startTime,duration:n.durationInMinutes,classId:n.id,waitingListCount:n.waitingListCount,isBooking:!1}})};w()}]),function(){"use strict";var n=angular.module("SatsElixia.Search",["app.api","app.service"]);n.controller("searchController",["$rootScope","$scope","searchApi","searchTrackingService",function(n,t,i,r){function u(n){return _.reduce(n,function(n,t){return n+t.Hits.length},0)}t.initSearch=function(n){t.language=n};t.performSearch=function(n){n.length>=3&&(t.isSearching?t.queryInQueue=n:(t.isSearching=!0,i.search(t.language,n).then(function(i){t.isSearching=!1;t.searchResult=i.data;r(n,u(i.data));t.queryInQueue!==null&&(t.performSearch(t.queryInQueue),t.queryInQueue=null)})))}}])}(),function(){"use strict";var n=1200,t=angular.module("SatsElixia.Search");t.service("searchTrackingService",["trackingService",function(t){return _.debounce(function(n,i){var r={event:"internalSearch",searchPhrase:n,searchResults:i};t.pushToDataLayer(r)},n)}])}();app=angular.module("SatsElixia.XForm",["ngNotify","ui.bootstrap.modal"]);app.directive("xform",["ngNotify","$http","centersApi","$modal",function(n,t,i,r){function u(n){r.open({animation:!0,template:$("#"+n).html(),size:"md",controller:"xformController",controllerAs:"vm"})}return{restrict:"A",link:function(r,f,e){$("body").on("click","#ShowConditionsLink-"+e.formId,function(n){u("Conditions-modal-"+e.formId);n.stopPropagation()});var o=f.find("form"),s=o.find("input[type='submit']"),c=$("#Conditions-"+e.formId).html(),l=o.attr("action"),h=o.find(".phoneno");h.length&&angular.forEach(h,function(n){satsSettings.country=="sv"?n.value="+46":satsSettings.country=="fi"?n.value="+358":satsSettings.country=="no"&&(n.value="+47")});e.isLeadForm&&(l+="&campaignCode="+(e.campaignCode?e.campaignCode:""),l+="&leadSource="+(e.leadSource?e.leadSource:""),i.getCenters().then(function(n){var i=[],e,r,u;for(angular.forEach(n.data.regions,function(n){i=i.concat(n.centers)}),i.sort(function(n,t){return n.name>t.name?1:-1}),e=f.find("input.centerid"),r=0;r<e.length;r++){var t=$(e.get(r)),o=t.attr("id"),s=t.attr("name");t&&(u='<select id="'+o+'" name="'+s+'">',angular.forEach(i,function(n){u+='<option value="'+n.id+'">'+n.name+"<\/option>"}),u+="<\/select>",t.replaceWith(u),t.attr("name","centerId"))}}),$(c).insertBefore(s.closest("tr")));s.click(function(){var i=!0,r,u;return h.length&&(angular.forEach(h,function(n){i=n.value.indexOf("+")>=0}),i||n.set(satsSettings.xformPhoneNoCountryCode,"error")),i&&(!c||c&&$("#AcceptConditionsCheckbox-"+e.formId).is(":checked"))?(r=o.serialize()+"&"+s.attr("name")+"="+s.val(),u={headers:{"Content-Type":"application/x-www-form-urlencoded"}},$(".container-xforms .load-icon-overlay-wrapper").removeClass("hidden"),t.post(l,r,u).then(function(t){$(".container-xforms .load-icon-overlay-wrapper").addClass("hidden");var i=t.data.Valid?"success":"error";t.data.Valid&&(o.trigger("reset"),t.data.RedirectUrl&&(window.location.href=t.data.RedirectUrl));n.set(t.data.Message,i)})):i&&($("#errorMsg").removeClass("hidden"),setTimeout(function(){$("#errorMsg").addClass("hidden")},2500)),!1})}}}]).controller("xformController",["$modalStack",function(n){var t=this;t.cancel=function(){n.dismissAll()}}]);InfoBox.prototype=new google.maps.OverlayView;InfoBox.prototype.createInfoBoxDiv_=function(){var n,t,i,u=this,r=function(n){n.cancelBubble=!0;n.stopPropagation&&n.stopPropagation()},f=function(n){n.returnValue=!1;n.preventDefault&&n.preventDefault();u.enableEventPropagation_||r(n)};if(!this.div_){if(this.div_=document.createElement("div"),this.setBoxStyle_(),typeof this.content_.nodeType=="undefined"?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:this.maxWidth_!==0&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(i=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-i.left-i.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),!this.enableEventPropagation_){for(this.eventListeners_=[],t=["mousedown","mouseover","mouseout","mouseup","click","dblclick","touchstart","touchend","touchmove"],n=0;n<t.length;n++)this.eventListeners_.push(google.maps.event.addDomListener(this.div_,t[n],r));this.eventListeners_.push(google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"}))}this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",f);google.maps.event.trigger(this,"domready")}};InfoBox.prototype.getCloseBoxImg_=function(){var n="";return this.closeBoxURL_!==""&&(n="<img",n+=" src='"+this.closeBoxURL_+"'",n+=" align=right",n+=" style='",n+=" position: relative;",n+=" cursor: pointer;",n+=" margin: "+this.closeBoxMargin_+";",n+="'>"),n};InfoBox.prototype.addClickHandler_=function(){var n;this.closeBoxURL_!==""?(n=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(n,"click",this.getCloseClickHandler_())):this.closeListener_=null};InfoBox.prototype.getCloseClickHandler_=function(){var n=this;return function(t){t.cancelBubble=!0;t.stopPropagation&&t.stopPropagation();google.maps.event.trigger(n,"closeclick");n.close()}};InfoBox.prototype.panBox_=function(n){var i,y,e=0,f=0,p;if(!n&&(i=this.getMap(),i instanceof google.maps.Map)){i.getBounds().contains(this.position_)||i.setCenter(this.position_);y=i.getBounds();var l=i.getDiv(),a=l.offsetWidth,o=l.offsetHeight,s=this.pixelOffset_.width,r=this.pixelOffset_.height,v=this.div_.offsetWidth,h=this.div_.offsetHeight,c=this.infoBoxClearance_.width,u=this.infoBoxClearance_.height,t=this.getProjection().fromLatLngToContainerPixel(this.position_);t.x<-s+c?e=t.x+s-c:t.x+v+s+c>a&&(e=t.x+v+s+c-a);this.alignBottom_?t.y<-r+u+h?f=t.y+r-u-h:t.y+r+u>o&&(f=t.y+r+u-o):t.y<-r+u?f=t.y+r-u:t.y+h+r+u>o&&(f=t.y+h+r+u-o);e===0&&f===0||(p=i.getCenter(),i.panBy(e,f))}};InfoBox.prototype.setBoxStyle_=function(){var n,t;if(this.div_){this.div_.className=this.boxClass_;this.div_.style.cssText="";t=this.boxStyle_;for(n in t)t.hasOwnProperty(n)&&(this.div_.style[n]=t[n]);this.div_.style.WebkitTransform="translateZ(0)";typeof this.div_.style.opacity!="undefined"&&this.div_.style.opacity!==""&&(this.div_.style.MsFilter='"progid:DXImageTransform.Microsoft.Alpha(Opacity='+this.div_.style.opacity*100+')"',this.div_.style.filter="alpha(opacity="+this.div_.style.opacity*100+")");this.div_.style.position="absolute";this.div_.style.visibility="hidden";this.zIndex_!==null&&(this.div_.style.zIndex=this.zIndex_)}};InfoBox.prototype.getBoxWidths_=function(){var i,n={top:0,bottom:0,left:0,right:0},t=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(i=t.ownerDocument.defaultView.getComputedStyle(t,""),i&&(n.top=parseInt(i.borderTopWidth,10)||0,n.bottom=parseInt(i.borderBottomWidth,10)||0,n.left=parseInt(i.borderLeftWidth,10)||0,n.right=parseInt(i.borderRightWidth,10)||0)):document.documentElement.currentStyle&&t.currentStyle&&(n.top=parseInt(t.currentStyle.borderTopWidth,10)||0,n.bottom=parseInt(t.currentStyle.borderBottomWidth,10)||0,n.left=parseInt(t.currentStyle.borderLeftWidth,10)||0,n.right=parseInt(t.currentStyle.borderRightWidth,10)||0),n};InfoBox.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)};InfoBox.prototype.draw=function(){this.createInfoBoxDiv_();var n=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=n.x+this.pixelOffset_.width+"px";this.alignBottom_?this.div_.style.bottom=-(n.y+this.pixelOffset_.height)+"px":this.div_.style.top=n.y+this.pixelOffset_.height+"px";this.div_.style.visibility=this.isHidden_?"hidden":"visible"};InfoBox.prototype.setOptions=function(n){typeof n.boxClass!="undefined"&&(this.boxClass_=n.boxClass,this.setBoxStyle_());typeof n.boxStyle!="undefined"&&(this.boxStyle_=n.boxStyle,this.setBoxStyle_());typeof n.content!="undefined"&&this.setContent(n.content);typeof n.disableAutoPan!="undefined"&&(this.disableAutoPan_=n.disableAutoPan);typeof n.maxWidth!="undefined"&&(this.maxWidth_=n.maxWidth);typeof n.pixelOffset!="undefined"&&(this.pixelOffset_=n.pixelOffset);typeof n.alignBottom!="undefined"&&(this.alignBottom_=n.alignBottom);typeof n.position!="undefined"&&this.setPosition(n.position);typeof n.zIndex!="undefined"&&this.setZIndex(n.zIndex);typeof n.closeBoxMargin!="undefined"&&(this.closeBoxMargin_=n.closeBoxMargin);typeof n.closeBoxURL!="undefined"&&(this.closeBoxURL_=n.closeBoxURL);typeof n.infoBoxClearance!="undefined"&&(this.infoBoxClearance_=n.infoBoxClearance);typeof n.isHidden!="undefined"&&(this.isHidden_=n.isHidden);typeof n.visible!="undefined"&&(this.isHidden_=!n.visible);typeof n.enableEventPropagation!="undefined"&&(this.enableEventPropagation_=n.enableEventPropagation);this.div_&&this.draw()};InfoBox.prototype.setContent=function(n){this.content_=n;this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),typeof n.nodeType=="undefined"?this.div_.innerHTML=this.getCloseBoxImg_()+n:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(n)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px",typeof n.nodeType=="undefined"?this.div_.innerHTML=this.getCloseBoxImg_()+n:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(n))),this.addClickHandler_());google.maps.event.trigger(this,"content_changed")};InfoBox.prototype.setPosition=function(n){this.position_=n;this.div_&&this.draw();google.maps.event.trigger(this,"position_changed")};InfoBox.prototype.setZIndex=function(n){this.zIndex_=n;this.div_&&(this.div_.style.zIndex=n);google.maps.event.trigger(this,"zindex_changed")};InfoBox.prototype.setVisible=function(n){this.isHidden_=!n;this.div_&&(this.div_.style.visibility=this.isHidden_?"hidden":"visible")};InfoBox.prototype.getContent=function(){return this.content_};InfoBox.prototype.getPosition=function(){return this.position_};InfoBox.prototype.getZIndex=function(){return this.zIndex_};InfoBox.prototype.getVisible=function(){return typeof this.getMap()=="undefined"||this.getMap()===null?!1:!this.isHidden_};InfoBox.prototype.show=function(){this.isHidden_=!1;this.div_&&(this.div_.style.visibility="visible")};InfoBox.prototype.hide=function(){this.isHidden_=!0;this.div_&&(this.div_.style.visibility="hidden")};InfoBox.prototype.open=function(n,t){var i=this;t&&(this.position_=t.getPosition(),this.moveListener_=google.maps.event.addListener(t,"position_changed",function(){i.setPosition(this.getPosition())}));this.setMap(n);this.div_&&this.panBox_()};InfoBox.prototype.close=function(){var n;if(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListeners_){for(n=0;n<this.eventListeners_.length;n++)google.maps.event.removeListener(this.eventListeners_[n]);this.eventListeners_=null}this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null);this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null);this.setMap(null)};myPtClipsApp=angular.module("SatsElixia.myPtCLipsApp",[]);myPtClipsApp.controller("MyPtClipsCtrl",["$scope","$http","ngNotify",function(n,t,i){n.gotoClip=function(r,u,f,e){var o=satsSettings.basePath+"ptwebshop/webapi/products/clipcards/"+satsSettings.country;n.clipcardsForCenterAndUser=[];n.startUrl=r;n.locationUrl=u;n.productName=e;n.isLoading=!0;t.get(o+"/"+f).success(function(t){n.clipcardsForCenterAndUser=t;var f="",r;angular.forEach(n.clipcardsForCenterAndUser,function(t){t.ProductName==n.productName&&(r="/"+t.ProductType,r+="/"+t.PtLevel,r+="/"+t.Clips)});r?(f=isEmbededInApp()?n.startUrl+"?mobile=1"+u+r:n.startUrl+u+r,window.location.href=f):i.set("Error, the old clip card cannot be purchased again, please choose a new clip card.","error")}).error(function(){i.set("Error, can not load clip cards","error")}).finally(function(){n.isLoading=!1})};n.getBuyPtClipsLink=function(n){return isEmbeddedInApp()?n+"?mobile=1":n}}]);sats=sats||{};sats.gaLib=function(){function f(n,t,i,u,f){g(t,"WebSales Member "+n,i,u,r(n),f)}function e(n,t,i,u,f,e){return nt(t,i,u,f,e,1,r(n))}function o(t){n("PtWebShop","PurchaseStep",t)}function s(t,i){n("UpgradeMembership","Upgraded","From "+t+" to "+i)}function h(t){n("UpgradeMembership","Viewed",t)}function c(t){n("GxStreaming","PlaybackStart",t)}function l(t,i){n("Booking","Click","NbrOfClicks-"+(t?"LoggedIn":"NotLoggedIn")+"-"+(i?"BookOk":"BookFail"))}function a(n,t,i){u("Booking","UserInteraction","TimeToBooked-"+(n?"LoggedIn":"NotLoggedIn")+"-"+(t?"BookOk":"BookFail"),i)}function v(n,t){u("Booking","UserInteraction","TimeToClick-"+(n?"LoggedIn":"NotLoggedIn"),t)}function y(t){t===1?n("Diary","Diary1mClickC7","Clicked"):t===3?n("Diary","Diary3mClickC7","Clicked"):n("Diary","Diary12mClickC7","Clicked")}function p(i,r){n("Diary",i,t(r))}function w(i,r){n("MyBookings",i,t(r))}function b(i,r){n("Settings",i,t(r))}function k(t){n("MyTrainingMain","MainBoxClick",t)}function t(n){return n?n:"Clicked"}function r(n){switch(n.toLowerCase()){case"se":return"SEK";case"no":return"NOK";case"fi":return"EUR";default:return""}}function d(){return(new Date).getTime()}function i(){}function g(n,t,i,r,u,f,e){var o={transactionId:n,transactionAffiliation:t,transactionTotal:i,transactionTax:u,transactionShipping:r,transactionCurrency:f,transactionProducts:e};it(o,"ecommercedata_loaded")}function nt(n,t,i,r,u,f,e){return{id:n,name:t,sku:i,category:r,price:u,quantity:f,currency:e}}function tt(n){ga("set","&uid",n);ga("set","dimension1",n)}function u(n,t,r,u){var f={hitType:"timing",timingCategory:n,timingAction:t};r!==undefined&&(f.timingVar=r);u!==undefined&&(f.timingValue=u);i("GA timing: "+JSON.stringify(f));ga("send",f)}function n(n,t,r,u){var f={hitType:"event",eventCategory:n,eventAction:t};r!==undefined&&(f.eventLabel=r);u!==undefined&&(f.eventValue=u);i("GA event: "+JSON.stringify(f));ga("send",f)}function it(n,t){t&&(n.event=t);window.dataLayer=window.dataLayer||[];window.dataLayer.push(n)}return{logClipcardTransaction:f,getClipcardItem:e,logPtWebShopPurchaseProgress:o,logUpgradeMembershipUpgraded:s,logUpgradeMembershipViewed:h,setUserId:tt,logGxStreamingStartPlayback:c,logBookingEvent:l,logBookingTiming:a,logBookingClickTiming:v,getTimeStamp:d,logMyPagesTrainingDiaryRangeAction:y,logMyPagesTrainingDiaryAction:p,logMyPagesBookingAction:w,logMyPagesSettingsAction:b,logMyLandingPagesAction:k,debugLog:i}}(),function(){"use strict";angular.module("app.api",[])}(),function(){"use strict";angular.module("app.booking-listing",["app.core","app.api"])}(),function(){"use strict";angular.module("app.booking",["app.core","sats.dropdown-filter","sats.dropdown-datetime","sats.collapse-autoclose","sats.open-login-modal","ngTouch"])}(),function(){"use strict";angular.module("app.core",["ui.bootstrap","ngNotify","ngCookies"]).config(["$sceDelegateProvider",function(n){n.resourceUrlWhitelist(["self","http://www.youtube.com/embed/**","https://www.youtube.com/embed/**"])}]).config(["$locationProvider",function(n){n.html5Mode({enabled:!0,requireBase:!1,rewriteLinks:!1})}])}(),function(){"use strict";angular.module("sats.carousel",["app.core"])}(),function(){"use strict";angular.module("sats.collapse-autoclose",["app.core"])}(),function(){"use strict";angular.module("sats.cookie-notice",["app.core"])}(),function(){"use strict";angular.module("sats.drag-select",["app.core","sats.drag-select-item"])}(),function(){"use strict";angular.module("sats.drag-select-item",["app.core"])}(),function(){"use strict";angular.module("sats.dropdown-datetime",["app.core","sats.drag-select"])}(),function(){"use strict";angular.module("sats.dropdown-filter",["app.core"])}(),function(){"use strict";angular.module("sats.open-login-modal",["app.core","SatsElixia.Login"])}(),function(){"use strict";angular.module("sats.sticky-footer",[])}(),function(){"use strict";angular.module("sats.video-modal",["app.core"])}(),function(){"use strict";function n(n,t,i){function u(n){return n=n?n:{},angular.merge({},f,n)}function e(t,i){return t=r+t,n.get(t,u(i))}function o(t,i,f){return t=r+t,i=i?i:{},n.post(t,i,u(f))}function s(t,i){return t=r+t,n.delete(t,u(i))}var r=i.servicePlatformEndpoint,f={headers:{"Content-Type":"application/json",accept:"application/json","X-CookieAuthentication":"Auth-SatsElixia="+t.get("Auth-SatsElixia")}};return{get:e,post:o,"delete":s}}angular.module("app.api").factory("api.base",n);n.$inject=["$http","$cookies","satsSettings"]}(),function(){"use strict";function n(n,t){function r(){return t.get(i)}function u(n){var r={bookingRequest:{classId:n}};return t.post(i,r)}function f(n){return t.delete(i+"/"+n)}var i=n+"/bookings";return{getBookings:r,createBooking:u,cancelBooking:f}}angular.module("app.api").factory("bookingApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n,t){function r(n){return t.get(i,n)}var i=n+"/centers";return{getCenters:r}}angular.module("app.api").factory("centersApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n,t){function r(n){return t.get(i+"/"+n)}function u(){return t.get(i)}function f(n){for(var r="?",i=Object.keys(n),t=0;t<i.length;t++)r+=i[t]+"="+n[i[t]].join(";"),t<i.length-1&&(r+="&");return r}function e(n){var r=f(n);return t.get(i+r)}var i=n+"/classes";return{getClass:r,getClasses:u,searchClasses:e}}angular.module("app.api").factory("classesApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n,t){function r(){return t.get(i)}var i=n+"/classtypes";return{getClasstypes:r}}angular.module("app.api").factory("classtypesApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(){function n(){return satsSettings.apiCountry}return"/sats-api/"+n()}angular.module("app.api").factory("endpoint",n);n.$inject=["$location"]}(),function(){"use strict";function n(n){function f(i){return n.get(t+satsSettings.country+"/"+i)}function e(t){return n.get(i+satsSettings.country+"/"+t)}function o(t,i){return n.get(r+satsSettings.country+"/"+t+"/"+i)}function s(t,i){return i=i?i:0,n.get(u+satsSettings.country+"/"+i+"/"+t)}var t=satsSettings.basePath+"webapi/productfilters/",i=satsSettings.basePath+"webapi/centerfilters/",r=satsSettings.basePath+"webapi/filteredproducts/",u=satsSettings.basePath+"webapi/filteredcenters/";return{getProductFilters:f,getCenterFilters:e,getProductsForFilter:o,getCentersForFilter:s}}angular.module("app.api").factory("filtersApi",n);n.$inject=["$http"]}(),function(){"use strict";function n(n,t){function r(n){return t.get(i,n)}var i=n+"/instructors";return{getInstructors:r}}angular.module("app.api").factory("instructorsApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n){function t(t,i,r){var u={UserName:t,Password:i,RememberMe:r};return n.post(satsSettings.basePath+"webapi/auth/login",u)}function i(t){var i={Username:t};return n.post(satsSettings.basePath+"webapi/auth/passwordreset",i)}return{performLogin:t,resetPassword:i}}angular.module("app.api").factory("loginApi",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function i(n){return{binding:{length:n.binding.length,unit:n.binding.unit},bindingEndDate:n.bindingEndDate,centerId:n.centerId,centerName:n.centerName,country:n.country,discount:n.discount,globalId:n.globalId,hasBinding:n.hasBinding,memberType:n.memberType,name:n.name,paymentType:n.paymentType,price:n.price,regionId:n.regionId,regionName:n.regionName,status:n.status,subscriptionName:n.subscriptionName,transferAllowed:n.transferAllowed,transferNewCenterAllowed:n.transferNewCenterAllowed}}function r(){return n.get(t).then(function(n){return i(n.data)})}var t="sats/membership/currentsubscription";return{getSubscription:r}}angular.module("app.api").factory("membershipApi",n);n.$inject=["api.base"]}(),function(){"use strict";function n(n,t){function r(n,r){return t.get(i+n+"/"+r)}var i=n+"/user/recommendations/";return{getRecommendationsForDate:r}}angular.module("app.api").factory("recommendationsApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n){function i(i,r){return n.get(t+i+"?query="+r)}var t=satsSettings.basePath+"webapi/search/";return{search:i}}angular.module("app.api").factory("searchApi",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function i(i){return n.get(t+i)}var t=satsSettings.basePath+"webapi/selectedarticles/"+satsSettings.country+"/";return{getSelectedArticles:i}}angular.module("app.api").factory("selectedArticlesApi",n);n.$inject=["$http"]}(),function(){"use strict";function n(n,t){function r(){return t.get(i)}function u(n,r,u,f,e,o){var s={name:n,classTypesAndCategories:r,centersAndRegions:u,timeIntervals:f,instructors:e,days:o};return t.post(i,s)}function f(n,r,u,f,e,o){var s={name:r,classTypesAndCategories:u,centersAndRegions:f,timeIntervals:e,instructors:o};return t.put(i+"/"+n,s)}function e(n){return t.delete(i+"/"+n)}var i=n+"/user/favorites/searches";return{getSearches:r,addSearch:u,updateSearch:f,deleteSearch:e,filterTypeGroup:1,filterTypeItem:0}}angular.module("app.api").factory("userFavoriteSearchesApi",n);n.$inject=["endpoint","$http"]}(),function(){"use strict";function n(n,t){function r(){i.ok=function(){n.close({item:i.item,name:i.name})};i.cancel=function(){n.dismiss("cancel")}}var i=this;i.name="";i.item=t;r()}angular.module("app.booking").controller("bookingAddOrUpdateFavoriteSearchModal",n);n.$inject=["$modalInstance","item"]}(),function(){"use strict";function n(n,t){function r(){i.ok=function(){n.close({item:t})};i.cancel=function(){n.dismiss("cancel")}}var i=this;i.item=t;r()}angular.module("app.booking-listing").controller("bookingCancelBookingModal",n);n.$inject=["$modalInstance","item"]}(),function(){"use strict"}(),function(){"use strict";function n(n,t,i,r,u,f,e,o,s){function b(){f.$on("$destroy",function(){i.updateSearch.unregisterCallback(a)});h.getClassTypeForId=function(t){return n.find(i.classTypes,function(n){return n.id==t})};h.isLoggedIn=i.isLoggedIn;v.isEmpty?h.isLoggedIn&&e.getObject("bookingquery-"+i.userid)&&i.promises.all.then(function(){var n=i.isValidQuery(e.getObject("bookingquery-"+i.userid));n&&(i.useFavoriteSearch(i.convertToPredefinedSearch(n),!0),y++,a(n))}):i.promises.all.then(function(){i.useFavoriteSearch(v,!0)})}function k(){return h.selectedCenters.length>0||h.selectedClass.length>0||h.selectedInstructor.length>0}function a(r){var f,u,s;if(y++==0&&(f=v.isEmpty==!0&&h.isLoggedIn?i.isValidQuery(e.getObject("bookingquery-"+i.userid)):w,f&&(r=f)),n.isEmpty(r)&&(r=i.getQueryFromFilters()),h.isLoggedIn&&(u=new Date,s=new Date(u.getFullYear()+1,u.getMonth(),u.getDate()),angular.forEach(r.dates,function(n,t,i){var u=parseDate(n),r=new Date;r.setHours(0,0,0,0);u<=r&&i.splice(t,1)}),e.putObject("bookingquery-"+i.userid,r,{expires:s})),h.isSearching)h.queryInQueue=r;else if(k())return h.isSearching=!0,i.searchClasses(r).then(function(n){var i,r;h.isSearching=!1;h.groupedClasses=n;i=function(n){angular.forEach(h.groupedClasses,function(i){angular.forEach(i.Classes,function(i){i.datetime=t.tz(i.datetime,n)})})};satsSettings.country=="fi"?i("Europe/Helsinki"):satsSettings.country=="sv"?i("Europe/Stockholm"):satsSettings.country=="no"&&i("Europe/Oslo");(h.queryInQueue!=undefined||h.queryInQueue!=null)&&(r=h.queryInQueue,h.queryInQueue=null,a(r))},function(){if(h.isSearching=!1,h.groupedClasses=[],o.set(satsSettings.booking.getClassInstancesFailed,"error"),h.queryInQueue!=undefined||h.queryInQueue!=null){var n=h.queryInQueue;h.queryInQueue=null;a(n)}})}function d(n){return l===null?!1:l.id===n.id}function g(n){if(h.isLoggedIn)return tt(n)}function nt(n){h.isLoggedIn=!0;c.timeBoookingClicked==null&&(c.timeBoookingClicked=sats.gaLib.getTimeStamp(),sats.gaLib.logBookingClickTiming(!1,c.timeBoookingClicked-c.timeFirstResultVisible));p(n.id).then(function(){o.set(satsSettings.booking.bookingSuccessful,"success");sats.gaLib.logBookingEvent(!1,!0);setTimeout(function(){window.location.reload()},400)},function(n){var t=i.humanizeApiError(n.data);o.set(t||satsSettings.booking.bookingFailed,{type:"error",sticky:!0,duration:1e4});sats.gaLib.logBookingEvent(!1,!1);setTimeout(function(){window.location.reload()},400)})}function tt(n){l=n;c.timeBoookingClicked==null&&(c.timeBoookingClicked=sats.gaLib.getTimeStamp(),sats.gaLib.logBookingClickTiming(!0,c.timeBoookingClicked-c.timeFirstResultVisible));p(n.id).then(function(){o.set(satsSettings.booking.bookingSuccessful,"success");sats.gaLib.logBookingEvent(!0,!0);l=null},function(n){var t=i.humanizeApiError(n.data);o.set(t||satsSettings.booking.bookingFailed,{type:"error",sticky:!0,duration:1e4});sats.gaLib.logBookingEvent(!0,!1);l=null})}function it(n){var t=u.open({animation:!0,templateUrl:satsSettings.basePath+"NgTemplates/booking-cancelbookingmodal",controller:"bookingCancelBookingModal",controllerAs:"vm",bindToController:!0,size:"lg",resolve:{item:function(){return n}}});t.result.then(function(n){ft(n.item.id).then(function(){o.set(satsSettings.booking.cancelBookingSuccessful,"success")},function(n){var t=i.humanizeApiError(n.data);o.set(t||satsSettings.booking.cancelBookingFailed,{type:"error",sticky:!0,duration:1e4})})},function(){})}function rt(n){h.expandedClass===n?h.expandedClass.showInfo?(h.expandedClass.showInfo=!1,h.expandedClass=null):(h.expandedClass.showCenterInfo=!1,h.expandedClass.showInfo=!0):(h.expandedClass!==null&&(h.expandedClass.showInfo=!1,h.expandedClass.showCenterInfo=!1),h.expandedClass=n,h.expandedClass.showInfo=!0)}function ut(n){h.expandedClass===n?h.expandedClass.showCenterInfo?(h.expandedClass.showCenterInfo=!1,h.expandedClass=null):(h.expandedClass.showInfo=!1,h.expandedClass.showCenterInfo=!0):(h.expandedClass!==null&&(h.expandedClass.showInfo=!1,h.expandedClass.showCenterInfo=!1),h.expandedClass=n,h.expandedClass.showCenterInfo=!0)}function p(n){return i.createBooking(n).then(function(){h.groupedClasses.updateBookings()})}function ft(n){return i.cancelBooking(n).then(function(){h.groupedClasses.updateBookings()})}function et(n){f.mobileHighlightedClass=f.mobileHighlightedClass?null:n}function ot(n){function r(n){return!n.booking&&n.isFull?n.waitingListCount:null}function u(n){return n.booking&&n.isFull&&n.booking.positionInQueue>0?n.booking.positionInQueue:null}var t,i=r(n);return i||(t=u(n)),i||t}var h=this;h.bookClickHandler=g;h.openCancelBookingModal=it;h.toggleClassInfo=rt;h.toggleCenterInfo=ut;h.closeClassInfo=function(n){n.showInfo=!1};h.closeCenterInfo=function(n){n.showCenterInfo=!1};h.expandedClass=null;h.isSearching=!1;h.isBooking=d;h.groupedClasses=[];h.logInAndBookClass=nt;h.toggleMobileInfo=et;h.queueNumber=ot;var y=0,v=i.getPredefinedSearchFromQueryString(),w=i.getQueryFromPredefinedSearch(v),l=null,c={loggedIn:!1,timePageLoaded:sats.gaLib.getTimeStamp(),timeFirstResultVisible:null,timeBoookingClicked:null};sats.gaLib.debugLog("GA: Page loaded");h.selectedCenters=[];s.$on("centerDDChanged",function(n,t){if(t.Checked)h.selectedCenters.push(t.Value);else{var i=h.selectedCenters.indexOf(t.Value);i!=-1&&h.selectedCenters.splice(i,1)}});h.selectedClass=[];s.$on("classDDChanged",function(n,t){if(t.Checked)h.selectedClass.push(t.Value);else{var i=h.selectedClass.indexOf(t.Value);i!=-1&&h.selectedClass.splice(i,1)}console.log(t)});h.selectedInstructor=[];s.$on("instructorDDChanged",function(n,t){if(t.Checked)h.selectedInstructor.push(t.Value);else{var i=h.selectedInstructor.indexOf(t.Value);i!=-1&&h.selectedInstructor.splice(i,1)}});b();s.$on("clickSearch",function(){a()});s.$on("bookings updated",function(){h.groupedClasses.updateBookings&&h.groupedClasses.updateBookings()})}angular.module("app.booking-listing").controller("bookingListing",n);n.$inject=["_","moment","bookingDataService","centersApi","$modal","$scope","$cookies","ngNotify","$rootScope"]}(),function(){"use strict";angular.module("app.booking");angular.module("app.booking").value("FilterItemDefaults",{Label:"",Value:null,Checked:!1,isOpen:!1,SubItems:null}).value("DateTimeItemDefaults",{Label:"",Value:"",DayOfMonth:"",Past:!1,Disabled:!1,Checked:!1,Column:0,Row:0,Date:null}).value("ListItemDefaults",{showInfo:!1})}(),function(){"use strict";function n(n,t,i,r,u,f,e,o,s){var h=this;h.filterClass=n;h.item=t;h.placeholder=i;h.requireTyping=r;h.weeks=u;h.timeitems=f;o.$on("close-modal-event",function(){e.close()});angular.element(s).bind("resize",function(){s.innerWidth>=500&&o.$broadcast("close-modal-event")})}function t(n,t,i,r,u){function o(){f.centerDropdownItems=t.centerDropdownItems;f.classDropdownItems=t.classDropdownItems;f.instructorDropdownItems=t.instructorDropdownItems;f.timeDropdownItems=t.timeDropdownItems;f.weeks=t.weeks;f.favoriteSearches=t.favoriteSearches;f.favoriteSearchesIsOpen=!1;f.disableMyFavoriteSearches=e;f.toggleMyFavoriteSearches=c;f.closeFavoriteSearches=function(){f.favoriteSearchesIsOpen=!1};f.isLoggedIn=t.isLoggedIn;f.clearAllFilters=s;f.updateSearch=h;f.centerDropdownItems.onSelectedChanged();f.classDropdownItems.onSelectedChanged();f.instructorDropdownItems.onSelectedChanged();f.timeDropdownItems.onSelectedChanged()}function s(){f.centerDropdownItems.clearAll();f.classDropdownItems.clearAll();f.instructorDropdownItems.clearAll();f.timeDropdownItems.clearAll()}function h(){u.$broadcast("clickSearch")}function e(){return f.favoriteSearches.length==0||satsSettings.userid===""}function c(n){e()||(n.preventDefault(),f.favoriteSearchesIsOpen=!f.favoriteSearchesIsOpen)}function l(n){var t=i.open({animation:!0,templateUrl:satsSettings.basePath+"NgTemplates/booking-addorupdatefavoritesearchmodal",controller:"bookingAddOrUpdateFavoriteSearchModal",controllerAs:"vm",bindToController:!0,size:"lg",resolve:{item:function(){return n}}});t.result.then(function(n){n.item?v(n.item.id,n.name):a(n.name)},function(){})}function a(i){var u=t.favoriteSearch.filterTypeGroup,e=t.favoriteSearch.filterTypeItem,o=n.map(f.classDropdownItems.selected,function(n){return{filterType:n.SubItems==null?e:u,id:n.Value}}),s=n.map(f.centerDropdownItems.selected,function(n){return{filterType:n.SubItems==null?e:u,id:n.Value}}),h=n.map(f.timeDropdownItems.selected,function(n){var t=n.Value.split(",");return{FromTime:t[0],ToTime:t[1]}}),c=n.chain(f.weeks.selected).map(function(n){return n.Date.day()}).uniq(),l=n.map(f.instructorDropdownItems.selected,function(n){return n.Value});return t.addFavoriteSearch(i,o,s,h,l,c).then(function(){r.set(satsSettings.booking.saveFavouriteSearchSuccessful,"success")},function(){r.set(satsSettings.booking.saveFavouriteSearchFailed,"error")})}function v(n,i){return t.updateFavoriteSearch(n,i).then(function(){r.set(satsSettings.booking.updateFavouriteSearchSuccessful,"success")},function(){r.set(satsSettings.booking.updateFavouriteSearchFailed,"error")})}function y(n){return t.deleteFavoriteSearch(n).then(function(){r.set(satsSettings.booking.deleteFavouriteSearchSuccessful,"success")},function(){r.set(satsSettings.booking.deleteFavouriteSearchFailed,"error")})}function p(n){t.useFavoriteSearch(n);u.$broadcast("clickSearch")}function w(){return f.weeks.selected.length+f.timeDropdownItems.selected.length+f.centerDropdownItems.selected.length+f.classDropdownItems.selected.length+f.instructorDropdownItems.selected.length}var f=this;f.openAddOrUpdateFavoriteSearchModal=l;f.deleteFavoriteSearch=y;f.useFavoriteSearch=p;f.getFilterCount=w;o();f.openFilterModal=function(n,t,r,u,f,e){var o=i.open({animation:!0,templateUrl:satsSettings.basePath+"NgTemplates/mobile-filter-modal",controller:"mobileFilterModal",controllerAs:"vm",bindToController:!0,size:"lg",resolve:{filterClass:function(){return n},item:function(){return t},placeholder:function(){return r},requireTyping:function(){if(u!=null||u!=undefined)return u},weeks:function(){if(f!=null||f!=undefined)return f},timeitems:function(){if(e!=null||e!=undefined)return e}}})}}angular.module("app.booking").controller("booking",t).controller("mobileFilterModal",n).directive("stopEvent",function(){return{restrict:"A",link:function(n,t,i){i&&i.stopEvent&&t.bind(i.stopEvent,function(n){n.stopPropagation()})}}});t.$inject=["_","bookingDataService","$modal","ngNotify","$rootScope"];n.$inject=["filterClass","item","placeholder","requireTyping","weeks","timeitems","$modalInstance","$rootScope","$window"]}(),function(){"use strict";function n(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){function vi(t){return ri=!1,t.dates&&t.dates.length!=0||(t.dates=n.chain(it).map(function(n){return n.Days}).flatten().filter(function(n){return n.Past==!1&&n.Date.diff(s(),"days")<7}).pluck("Date").map(function(n){return n.format("YYYYMMDD")}).value()),l.searchClasses(t).then(function(n){var t=[ct];return dt&&t.push(dt),r.all(t).then(function(){var t=yi(n);return t.updateBookings(),t})})}function yi(t){var r=n.map(t.data.classes,function(n){return hi(n)}),i=n(r).chain().sortBy(function(n){return n.name}).sortBy(function(n){return n.datetime}).value(),u=n.groupBy(i,"date"),f=n.map(u,function(n){return{Date:n[0].date,Classes:n}});return n.extend(f,new ai(i))}function pi(){return a.getCenters().then(function(t){return n.each(t.data.regions,function(t){t.centers=n.sortBy(t.centers,function(n){return n.name})}),n.sortBy(t.data.regions,function(n){return n.name})})}function wi(){return v.getClasstypes().then(function(t){return{classCategories:n.sortBy(t.data.classCategories,function(n){return n.name}),classTypes:n.chain(t.data.classTypes).filter(function(n){return n.isAvailableInBooking}).sortBy(function(n){return n.name}).value()}})}function bi(){return y.getInstructors().then(function(t){return n.sortBy(t.data.instructors,function(n){return n.name})})}function ki(){return p.getSearches().then(function(t){return n.sortBy(t.data,function(n){return n.name})})}function di(n,t,i,r,u,f){return p.addSearch(n,t,i,r,u,f).then(function(n){return ft.push(ti(n.data)),n.data})}function gi(t,i){var r=n.find(ft,function(n){return n.id==t});return p.updateSearch(t,i,r.classTypesAndCategories,r.centersAndRegions,r.timeIntervals,r.instructors).then(function(n){return ft.replace(r,ti(n.data)),n.data})}function nr(t){return p.deleteSearch(t).then(function(i){var r=n.find(ft,function(n){return n.id==t});return r&&ft.remove(r),i.data})}function tr(t,i){var u,f,r;t&&(i!==!0&&(i=!1),!t.classTypesAndCategories||(u=tt.getFlat(),n.each(tt,function(n){tt.check(n,!1,i)}),n.each(t.classTypesAndCategories,function(t){var r=n.find(u,function(n){return t.filterType===0&&n.Value===t.id||t.filterType===1&&n.Value===t.id&&n.SubItems!=null});r&&tt.check(r,!0,i)})),!t.centersAndRegions||(f=g.getFlat(),n.each(g,function(n){g.check(n,!1,i)}),n.each(t.centersAndRegions,function(t){var r=n.find(f,function(n){return n.Value.toLowerCase()==t.id.toLowerCase()});r&&g.check(r,!0,i)})),!t.timeIntervals||(n.each(ut,function(n){ut.check(n,!1,i)}),n.each(t.timeIntervals,function(t){var r=n.find(ut,function(n){return n.Value==t.FromTime+","+t.ToTime});r&&ut.check(r,!0,i)})),!t.instructors||(n.each(rt,function(n){rt.check(n,!1,i)}),n.each(t.instructors,function(t){var r=n.find(rt,function(n){return n.Value.toLowerCase()==t.toLowerCase()});r&&rt.check(r,!0,i)})),!t.dates||(r=it.getFlat(),n.each(r,function(n){it.check(n,!1,!i)}),n.each(t.dates,function(t){var u=n.find(r,function(n){return n.Value.toLowerCase()==t.toLowerCase()&&n.Disabled==!1});u&&it.check(u,!0,!i)})))}function ir(){var t={},s=n.pluck(it.selected,"Value"),i,r,u,f,e,o;return s.length>0&&(t.dates=s),i=n.pluck(ut.selected,"Value"),i.length>0&&(t.timeIntervals=i),r=n.chain(g.selected).filter(function(n){return n.SubItems==null}).pluck("Value").value(),r.length>0&&(t.centers=r),u=n.chain(g.selected).filter(function(n){return n.SubItems!=null}).pluck("Value").value(),u.length>0&&(t.regions=u),f=n.chain(tt.selected).filter(function(n){return n.SubItems==null}).pluck("Value").value(),f.length>0&&(t.classTypes=f),e=n.chain(tt.selected).filter(function(n){return n.SubItems!=null}).pluck("Value").value(),e.length>0&&(t.classCategories=e),o=n.pluck(rt.selected,"Value"),o.length>0&&(t.instructors=o),t}function rr(t){var i={},r,u,f,e,o,s;return t.dates.length>0&&(i.dates=t.dates),r=n.map(t.timeIntervals,function(n){return n.FromTime+","+n.ToTime}),r.length>0&&(i.timeIntervals=r),u=n.chain(t.centersAndRegions).filter(function(n){return n.filterType==p.filterTypeItem}).pluck("id").value(),u.length>0&&(i.centers=u),f=n.chain(t.centersAndRegions).filter(function(n){return n.filterType==p.filterTypeGroup}).pluck("id").value(),f.length>0&&(i.regions=f),e=n.chain(t.classTypesAndCategories).filter(function(n){return n.filterType==p.filterTypeItem}).pluck("id").value(),e.length>0&&(i.classTypes=e),o=n.chain(t.classTypesAndCategories).filter(function(n){return n.filterType==p.filterTypeGroup}).pluck("id").value(),o.length>0&&(i.classCategories=o),s=t.instructors,s.length>0&&(i.instructors=s),i}function ur(n){return n&&typeof n=="object"?n:undefined}function fr(){var n={classTypes:k.classTypes||[],classCategories:k.classCategories||[],centers:k.centers||[],regions:k.regions||[],timeIntervals:k.timeIntervals||[],instructors:k.instructors||[],dates:k.dates||[]};return ei(n)}function ei(t){t||(t={});t.classCategories||(t.classCategories=[]);t.classTypes||(t.classTypes=[]);t.regions||(t.regions=[]);t.centers||(t.centers=[]);t.timeIntervals||(t.timeIntervals=[]);t.instructors||(t.instructors=[]);t.dates||(t.dates=[]);var i={classTypesAndCategories:n.map(t.classCategories,function(n){return{filterType:p.filterTypeGroup,id:n}}).concat(n.map(t.classTypes,function(n){return{filterType:p.filterTypeItem,id:n}})),centersAndRegions:n.map(t.regions,function(n){return{filterType:p.filterTypeGroup,id:n}}).concat(n.map(t.centers,function(n){return{filterType:p.filterTypeItem,id:n}})),timeIntervals:n.map(t.timeIntervals,function(n){return{FromTime:n.split(",")[0],ToTime:n.split(",")[1]}}),instructors:t.instructors,dates:t.dates};return i.isEmpty=i.classTypesAndCategories.length==0&&i.centersAndRegions.length==0&&i.timeIntervals.length==0&&i.instructors.length==0&&i.dates.length==0,i}function er(){return c.getBookings().then(function(n){return n.data.bookings})}function or(n){return c.createBooking(n).then(function(n){return et.push(n.data.booking),d.$broadcast("bookings updated"),n.data.booking})}function sr(t){return c.cancelBooking(t).then(function(i){var r=n.find(et,function(n){return n.id==t});return r&&(et.remove(r),d.$broadcast("bookings updated")),i.data})}var st,yt=n.extend([],f),ri=!0,nt=function(t){return n.defaults(t,e)},oi=function(t){return n.defaults(t,o)},ui=function(){return n.extend(function(){return{}}(),f)},ht=function(){return n.extend(function(){function t(n){var t=f(this);ri?t.length>0?d.$broadcast("filterButtonTxt","choose"):d.$broadcast("filterButtonTxt","close"):d.$broadcast("filterButtonTxt","choose");this.selected.replaceall(t);n!=!0&&(st&&h.cancel(st),st=h(ii,100))}function i(){var n=this,t=n.getFlat();t.length>2&&angular.forEach(t,function(t){t.Checked&&n.check(t,!1)})}function r(){var n=this;angular.forEach(n,function(t){t.Checked||n.check(t,!0)})}function u(n,t,i){t!=undefined&&(n.Checked=t);e.apply(this,[n]);this.onSelectedChanged(i);d.$broadcast("centerDDChanged",n)}function f(t){var r=n.flatten(n.map(t,function(n){return n.Checked==!0?n.SubItems:[]})),u=n.flatten(n.map(t,function(n){return n.Checked!=!0?n.SubItems:n})),f=n.filter(u,function(n){return n!=null&&n.Checked==!0}),e=n.difference(f,r),o=n.sortBy(i,function(n){return n.Label}),i=n.uniq(e);return i}function e(t){if(t.SubItems)for(var i=0;i<t.SubItems.length;i++)t.SubItems[i].Checked=t.Checked;n.each(this,function(n){var t,i;if(n.SubItems&&!(n.SubItems.length<=0)){for(t=!0,i=0;i<n.SubItems.length;i++)t=t&&n.SubItems[i].Checked;n.Checked=t}})}function o(){return n.flatten(n.map(this,function(n){return n.SubItems==null?n:n.SubItems.concat(n)}))}return{selected:n.extend([],new ui),onSelectedChanged:t,check:u,getFlat:o,clearAll:i,chooseAll:r}}(),f)},si=function(){return n.extend(function(){function t(){var n=this;angular.forEach(n,function(t){angular.forEach(t,function(t){angular.forEach(t,function(t){t.Checked&&n.check(t,!1)})})});d.$broadcast("clearAllClick")}function i(){var n=this,t=0;angular.forEach(n,function(i){angular.forEach(i,function(i){angular.forEach(i,function(i){typeof i=="object"&&t<15&&!i.Past&&(i.Checked||n.check(i,!0),t++)})})})}function r(){var n=e(this);this.selected.replaceall(n)}function u(){st&&h.cancel(st);st=h(ii,100)}function f(n,t,i){t!=undefined&&(n.Checked=t);this.onSelectedChanged();i==!0&&this.onSelectEnd()}function e(t){var i=n.flatten(n.map(t,function(n){return n.Days})),r=n.filter(i,function(n){return n.Checked==!0});return n.sortBy(r,function(n){return n.date})}function o(){return n.flatten(n.map(this,function(n){return n.Days}))}return{selected:n.extend([],new ui),onSelectedChanged:r,onSelectEnd:u,check:f,getFlat:o,clearAll:t,chooseAll:i}}(),f)},pt=n.extend([],f),g=n.extend([],new ht),ct=pi().then(function(t){pt.addrange(n.chain(t).map(function(n){return n.centers}).flatten().value());g.addrange(n.chain(t).map(function(t){return nt({Label:t.name,Value:t.id,SubItems:n.chain(t.centers).filter(function(n){return n.availableForOnlineBooking==!0}).map(function(n){return nt({Label:n.name,Value:n.id})}).value()})}).filter(function(n){return n.SubItems.length>0}).value());g.length==1&&g[0].SubItems&&g[0].SubItems.length==1&&(g.hide=!0,g.check(g[0].SubItems[0],!0),d.$broadcast("clickSearch"))},function(){u.set(b.booking.getCentersFailed,"error")}),tt=n.extend([],new ht),wt=n.extend([],f),bt=wi().then(function(t){tt.addrange(n.map(t.classCategories,function(n){return nt({Label:n.name,Value:n.id})}));var i=n.chain(t.classTypes).filter(function(n){return n.classCategories.length>0}).map(function(t){return nt(n.extend(t,{Label:t.name,Value:t.id}))}).value();n.each(i,function(t){n.each(t.classCategories,function(i){var r=n.find(tt,function(n){return n.Value==i});r&&(r.SubItems=r.SubItems||[],r.SubItems.push(t))})});wt.addrange(t.classTypes)},function(){u.set(b.booking.getClassTypesFailed,"error")}),rt=n.extend([],new ht),kt=bi().then(function(t){rt.addrange(n.map(t,function(n){return nt({Label:n.name,Value:n.id})}))},function(){u.set(b.booking.getInstructorsFailed,"error")}),ft=n.extend([],f),ut,dt,et,at,ni,vt,fi;b.isLoggedIn&&ki().then(function(t){r.all([kt,bt,ct]).then(function(){ft.addrange(n.map(t,function(n){return ti(n)}))})},function(){u.set(b.booking.getFavoriteSearchesFailed,"error")});ut=n.extend([nt({Label:b.timeOfDay.morning+" (05:00 - 09:00)",Value:"5,9"}),nt({Label:b.timeOfDay.prenoon+" (09:00 - 11:00)",Value:"9,11"}),nt({Label:b.timeOfDay.noon+" (11:00 - 13:00)",Value:"11,13"}),nt({Label:b.timeOfDay.afternoon+" (13:00 - 17:00)",Value:"13,17"}),nt({Label:b.timeOfDay.evening+" (17:00 - 22:00)",Value:"17,22"})],new ht);et=n.extend([],f);b.isLoggedIn&&(dt=er().then(function(n){et.addrange(n);d.$broadcast("bookings updated")},function(){u.set(b.booking.getUserBookingsFailed,"error")}));var gt=0,lt=s(),ot=s(lt).subtract(lt.isoWeekday()-1,"day"),it=[];for(at=0;at<3;at++){for(ni={Days:[]},vt=0;vt<7;vt++)ot.diff(lt,"days")>=0&&gt++,fi=oi({Label:ot.format("dddd (D/M)"),Value:ot.format("YYYYMMDD"),DayOfMonth:ot.format("D"),Past:ot.diff(lt,"days")<0,Disabled:gt==0||gt>b.bookableDaysCount,Checked:!1,Column:vt,Row:at,Date:ot.clone()}),ni.Days.push(fi),ot.add(1,"day");it.push(ni)}it=n.extend(it,new si);var hi=function(t){var i=n.extend(n.defaults(t,w),new li),u,r;return i.datetime=s(i.startTime),i.date=s(i.startTime).startOf("day"),u=n.find(pt,function(n){return n.id==i.centerFilterId}),i.center=u,i.isFull=i.bookedPersonsCount>=i.maxPersonsCount,r=n.findWhere(wt,{id:t.classTypeId}),r&&(i.onlineTrainingPageUrl=r.onlineTrainingPageUrl),i},ti=function(t){var i=t;return i.classTypesAndCategoriesLabel=n.map(i.classTypesAndCategories,function(t){var i=n.find(tt.getFlat(),function(n){return t.filterType===0&&n.Value===t.id||t.filterType===1&&n.Value===t.id&&n.SubItems!=null});return i?i.Label:""}).join(", ")||undefined,i.timeIntervalsLabel=n.map(i.timeIntervals,function(t){var i=n.find(ut.getFlat(),function(n){return n.Value==t.FromTime+","+t.ToTime});return i?i.Label:""}).join(", ")||undefined,i.centersAndRegionsLabel=n.map(i.centersAndRegions,function(t){var i=n.find(g.getFlat(),function(n){return n.Value==t.id});return i?i.Label:""}).join(", ")||undefined,i.instructorsLabel=n.map(i.instructors,function(t){var i=n.find(rt.getFlat(),function(n){return n.Value==t});return i?i.Label:""}).join(", ")||undefined,i.daysLabel=n.map(i.days,ci).join(", ")||undefined,i},ci=function(n){return n>99?b.booking.next+s(n%100,"d").format("dddd").toLowerCase():s(n,"d").format("dddd")},li=function(){return n.extend(function(){return{}}(),f)},ai=function(t){return n.extend(function(){function i(){n.each(this.flat,function(t){t.booking=n.find(et,function(n){return n.class.id==t.id})})}return{flat:t,updateBookings:i}}(),f)};var hr=function(n){yt.push(n)},cr=function(n){yt.remove(n)},ii=function(){angular.forEach(yt,function(n){n()})},lr=function(t){var r=t.errorKey,e=t.errorCode,u=t.errorDetails,i=function(t){var i=n.findWhere(u,{Type:t});return i?i.Info:""},f=function(n,t,i){var u=new RegExp("\\{"+t+"(?:\\:([^\\}]+))?\\}","gi"),r=u.exec(n);return r&&r.length>1?n.replace(r[0],i(r[1])):n};switch(r){case"TOO_EARLY_TO_BOOK_PARTICIPANT":return f(b.booking.errors.TOO_EARLY_TO_BOOK_PARTICIPANT,"date",function(n){return s(i("EARLIEST_ALLOWED_BOOKING_DATE")+" "+i("EARLIEST_ALLOWED_BOOKING_TIME")).format(n)});case"PARTICIPANT_TOO_MANY_OPEN_BOOKINGS":return b.booking.errors.PARTICIPANT_TOO_MANY_OPEN_BOOKINGS;case"PARTICIPATION_PERSON_DOUBLE_PARTICIPATION":return b.booking.errors.PARTICIPATION_PERSON_DOUBLE_PARTICIPATION;case"TOO_LATE_TO_CANCEL_BY_CUSTOMER":return b.booking.errors.TOO_LATE_TO_CANCEL_BY_CUSTOMER;case"PARTICIPANT_ALREADY_BOOKED":return b.booking.errors.PARTICIPANT_ALREADY_BOOKED;case"BOOKING_RESTRICTION":return b.booking.errors.BOOKING_RESTRICTION;case"PARTICIPATION_PERSON_BLOCKED":return b.booking.errors.PARTICIPATION_PERSON_BLOCKED;case"TOO_LATE_TO_BOOK_PARTICIPANT":return b.booking.errors.TOO_LATE_TO_BOOK_PARTICIPANT;case"IN_ADVANCE_LIMIT_BOOKING_RESTRICTION":return b.booking.errors.IN_ADVANCE_LIMIT_BOOKING_RESTRICTION;case"BOOKINGS_IN_FREEZE_PERIOD":case"CANNOT_PARTICIPATE_IN_FREEZE_PERIOD":return b.booking.errors.BOOKINGS_IN_FREEZE_PERIOD;case"NO_PRIVILEGE_FOR_PARTICIPATION":return b.booking.errors.NO_PRIVILEGE_FOR_PARTICIPATION;case"PARTICIPANT_OCCUPIED":return b.booking.errors.PARTICIPANT_OCCUPIED}return undefined};return{centerDropdownItems:g,classDropdownItems:tt,instructorDropdownItems:rt,timeDropdownItems:ut,weeks:it,classTypes:wt,favoriteSearches:ft,addFavoriteSearch:di,updateFavoriteSearch:gi,deleteFavoriteSearch:nr,useFavoriteSearch:tr,favoriteSearch:{filterTypeGroup:p.filterTypeGroup,filterTypeItem:p.filterTypeItem},getQueryFromFilters:ir,getQueryFromPredefinedSearch:rr,getPredefinedSearchFromQueryString:fr,convertToPredefinedSearch:ei,isValidQuery:ur,searchClasses:vi,createBooking:or,cancelBooking:sr,updateSearch:{registerCallback:hr,unregisterCallback:cr,notify:ii},centers:pt,bookings:et,isLoggedIn:b.isLoggedIn,userid:b.userid,promises:{all:r.all([kt,bt,ct]),instructors:kt,classtypes:bt,centers:ct},humanizeApiError:lr}}angular.module("app.booking").factory("bookingDataService",n);n.$inject=["_","$http","$location","$q","ngNotify","ExtendArray","FilterItemDefaults","DateTimeItemDefaults","moment","$timeout","bookingApi","classesApi","centersApi","classtypesApi","instructorsApi","userFavoriteSearchesApi","ListItemDefaults","satsSettings","querystring","$rootScope"]}(),function(){"use strict";function n(n,t,i){function f(){var n=location.search.substr(1).split("&");return t.object(t.map(n,function(n){var t=n.split("=");return[t[0],decodeURIComponent((t[1]||"").replace(/\+/g," ")).split(",")]}))}var r=satsSettings.country=="no"?"nb":satsSettings.country,u;n.locale(r);u=n.weekdays();n.locale(r,{weekdays:function(t){if(t.relativeWeekdays){if(t.isSame(n(),"day"))return satsSettings.today;if(t.isSame(n().add(1,"days"),"day"))return satsSettings.tomorrow}return u[t.day()]}});t.defaults(i,f())}angular.module("app.core").run(n).value("_",_).value("moment",moment).value("Math",Math).value("satsSettings",satsSettings).value("querystring",{});n.$inject=["moment","_","querystring"];var t=function(){function n(){this.splice(0,this.length)}function t(n){var t=this.indexOf(n);t>=0&&this.splice(t,1)}function i(n){for(var t=0;t<n.length;t++)this.push(n[t])}function r(n){this.clear();this.addrange(n)}function u(n,t){var i=this.indexOf(n);i>=0&&(this[i]=t)}return{addrange:i,clear:n,remove:t,replaceall:r,replace:u}}();angular.module("app.core").value("ExtendArray",t)}(),function(){"use strict";angular.module("app.core").filter("dateFormat",["moment",function(n){function t(t,i,r){if(typeof t=="undefined"||t===null)return"";var u=n(t);return u.isValid()?(r&&(u.relativeWeekdays=!0),u.format(i)):""}return t}])}(),function(){mainController.directive("topNavStyleChanges",["$window",function(n){function t(n,t){n.isTopNavTransparent=r(n,t)?!0:!1;n.isUnpinnedFreeZone=i(n,t)?!0:!1;n.$evalAsync()}function i(n,t){var i=250;return $(".hero-unit").length>0&&(i=$(".hero-unit").height()+t.height()*2),$(window).scrollTop()>i?!1:!0}function r(n,t){return $(window).scrollTop()<$("#firstHero").height()-t.height()&&$("body").hasClass("fade-header")?!0:!1}return function(i,r){t(i,r);angular.element(n).bind("scroll",function(){t(i,r)})}}]);mainController.directive("fadeImage",["$window",function(n){function t(n,t){if($("body").hasClass("fade-header")){var r=$(window).scrollTop(),i=$(".hero-unit"),u=(i.height()-r)/i.height();$("#firstHero ."+t.attr("class")).css({opacity:u})}n.$evalAsync()}return function(i,r){t(i,r);angular.element(n).bind("scroll",function(){t(i,r)})}}])}(),function(){"use strict";function n(){return function(n,t){if(checkBrowserBreakpointSize()==="xs"||checkBrowserBreakpointSize()==="sm"){var i=t.children().children("input, .input");i.bind("focus, click",function(n){if($(".dropdown-menu.open").length>0){var i=$("#"+n.target.parentElement.parentElement.parentElement.id).offset().top,t=i-100;t<15&&(t=15);$("html, body").animate({scrollTop:t},300)}})}}}angular.module("sats.dropdown-filter").directive("filterScroll",n)}(),function(){"use strict";angular.module("sats.carousel").controller("carouselController",["$scope",function(){}]).directive("satsCarousel",[function(){return{link:function(n,t,i){$("#"+i.carouselId).on("slide.bs.carousel",function(n){var t=$(n.relatedTarget).data("index");angular.forEach($("#"+i.carouselId+"-container .extraContentArea"),function(n){var i=$(n);i.data("index")===t?(i.removeClass("hidden"),i.addClass("visible-xs")):(i.removeClass("visible-xs"),i.addClass("hidden"))})});$(".carousel").swipeleft(function(){$(".right").click();$(".carousel").carousel("pause")});$(".carousel").swiperight(function(){$(".left").click();$(".carousel").carousel("pause")});$(".left").click(function(){$(".carousel").carousel("pause")});$(".right").click(function(){$(".carousel").carousel("pause")})}}}])}(),function(n,t,i){typeof define=="function"&&define.amd?define(["jquery"],function(r){return i(r,n,t),r.mobile}):i(n.jQuery,n,t)}(this,document,function(n,t,i){(function(n,t,i,r){function h(n){while(n&&typeof n.originalEvent!="undefined")n=n.originalEvent;return n}function vt(t,i){var u=t.type,e,o,l,f,s,a,v,c,y;if(t=n.Event(t),t.type=i,e=t.originalEvent,o=n.event.props,u.search(/^(mouse|click)/)>-1&&(o=gt),e)for(v=o.length,f;v;)f=o[--v],t[f]=e[f];if(u.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),u.search(/^touch/)!==-1&&(l=h(e),u=l.touches,s=l.changedTouches,a=u&&u.length?u[0]:s&&s.length?s[0]:r,a))for(c=0,y=ct.length;c<y;c++)f=ct[c],t[f]=a[f];return t}function v(t){for(var i={},r,u;t;){r=n.data(t,o);for(u in r)r[u]&&(i[u]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function yt(t,i){for(var r;t;){if(r=n.data(t,o),r&&(!i||r[i]))return t;t=t.parentNode}return null}function pt(){l=!1}function tt(){l=!0}function wt(){s=0;y.length=0;d=!1;tt()}function bt(){pt()}function w(){it();c=setTimeout(function(){c=0;wt()},n.vmouse.resetTimerDuration)}function it(){c&&(clearTimeout(c),c=0)}function f(t,i,r){var u;return(r&&r[t]||!r&&yt(i.target,t))&&(u=vt(i,t),n(i.target).trigger(u)),u}function rt(t){var r=n.data(t.target,b),i;d||s&&s===r||(i=f("v"+t.type,t),i&&(i.isDefaultPrevented()&&t.preventDefault(),i.isPropagationStopped()&&t.stopPropagation(),i.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function ut(t){var o=h(t).touches,r,i,u;o&&o.length===1&&(r=t.target,i=v(r),i.hasVirtualBinding&&(s=ni++,n.data(r,b,s),it(),bt(),e=!1,u=h(t).touches[0],lt=u.pageX,at=u.pageY,f("vmouseover",t,i),f("vmousedown",t,i)))}function ft(n){l||(e||f("vmousecancel",n,v(n.target)),e=!0,w())}function et(t){if(!l){var i=h(t).touches[0],o=e,r=n.vmouse.moveDistanceThreshold,u=v(t.target);e=e||Math.abs(i.pageX-lt)>r||Math.abs(i.pageY-at)>r;e&&!o&&f("vmousecancel",t,u);f("vmousemove",t,u);w()}}function ot(n){var t,i,r;l||(tt(),t=v(n.target),f("vmouseup",n,t),e||(r=f("vclick",n,t),r&&r.isDefaultPrevented()&&(i=h(n).changedTouches[0],y.push({touchID:s,x:i.clientX,y:i.clientY}),d=!0)),f("vmouseout",n,t),e=!1,w())}function st(t){var i=n.data(t,o),r;if(i)for(r in i)if(i[r])return!0;return!1}function ht(){}function kt(t){var i=t.substr(1);return{setup:function(){st(this)||n.data(this,o,{});var r=n.data(this,o);r[t]=!0;u[t]=(u[t]||0)+1;u[t]===1&&p.bind(i,rt);n(this).bind(i,ht);g&&(u.touchstart=(u.touchstart||0)+1,u.touchstart===1&&p.bind("touchstart",ut).bind("touchend",ot).bind("touchmove",et).bind("scroll",ft))},teardown:function(){--u[t];u[t]||p.unbind(i,rt);g&&(--u.touchstart,u.touchstart||p.unbind("touchstart",ut).unbind("touchmove",et).unbind("touchend",ot).unbind("scroll",ft));var r=n(this),f=n.data(this,o);f&&(f[t]=!1);r.unbind(i,ht);st(this)||r.removeData(o)}}}var o="virtualMouseBindings",b="virtualTouchID",k="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),ct="clientX clientY pageX pageY screenX screenY".split(" "),dt=n.event.mouseHooks?n.event.mouseHooks.props:[],gt=n.event.props.concat(dt),u={},c=0,lt=0,at=0,e=!1,y=[],d=!1,l=!1,g="addEventListener"in i,p=n(i),ni=1,s=0,nt,a;for(n.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},a=0;a<k.length;a++)n.event.special[k[a]]=kt(k[a]);g&&i.addEventListener("click",function(t){var f=y.length,e=t.target,o,s,i,r,u,h;if(f)for(o=t.clientX,s=t.clientY,nt=n.vmouse.clickDistanceThreshold,i=e;i;){for(r=0;r<f;r++)if(u=y[r],h=0,i===e&&Math.abs(u.x-o)<nt&&Math.abs(u.y-s)<nt||n.data(i,b)===u.touchID){t.preventDefault();t.stopPropagation();return}i=i.parentNode}},!0)})(n,t,i),function(n){n.mobile={}}(n),function(n){var t={touch:"ontouchend"in i};n.mobile.support=n.mobile.support||{};n.extend(n.support,t);n.extend(n.mobile.support,t)}(n),function(n,t,r){function u(t,i,r){var u=r.type;r.type=i;n.event.dispatch.call(t,r);r.type=u}var e=n(i);n.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,i){n.fn[i]=function(n){return n?this.bind(i,n):this.trigger(i)};n.attrFn&&(n.attrFn[i]=!0)});var f=n.mobile.support.touch,s="touchmove scroll",h=f?"touchstart":"mousedown",c=f?"touchend":"mouseup",o=f?"touchmove":"mousemove";n.event.special.scrollstart={enabled:!0,setup:function(){function i(n,i){t=i;u(r,t?"scrollstart":"scrollstop",n)}var r=this,e=n(r),t,f;e.bind(s,function(r){n.event.special.scrollstart.enabled&&(t||i(r,!0),clearTimeout(f),f=setTimeout(function(){i(r,!1)},50))})}};n.event.special.tap={tapholdThreshold:750,setup:function(){var t=this,i=n(t);i.bind("vmousedown",function(r){function f(){clearTimeout(c)}function o(){f();i.unbind("vclick",s).unbind("vmouseup",f);e.unbind("vmousecancel",o)}function s(n){o();h===n.target&&u(t,"tap",n)}if(r.which&&r.which!==1)return!1;var h=r.target,l=r.originalEvent,c;i.bind("vmouseup",f).bind("vclick",s);e.bind("vmousecancel",o);c=setTimeout(function(){u(t,"taphold",n.Event("taphold",{target:h}))},n.event.special.tap.tapholdThreshold)})}};n.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(t){var i=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[i.pageX,i.pageY],origin:n(t.target)}},stop:function(n){var t=n.originalEvent.touches?n.originalEvent.touches[0]:n;return{time:(new Date).getTime(),coords:[t.pageX,t.pageY]}},handleSwipe:function(t,i){i.time-t.time<n.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-i.coords[0])>n.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-i.coords[1])<n.event.special.swipe.verticalDistanceThreshold&&t.origin.trigger("swipe").trigger(t.coords[0]>i.coords[0]?"swipeleft":"swiperight")},setup:function(){var i=this,t=n(i);t.bind(h,function(i){function e(t){u&&(f=n.event.special.swipe.stop(t),Math.abs(u.coords[0]-f.coords[0])>n.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())}var u=n.event.special.swipe.start(i),f;t.bind(o,e).one(c,function(){t.unbind(o,e);u&&f&&n.event.special.swipe.handleSwipe(u,f);u=f=r})})}};n.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(t,i){n.event.special[t]={setup:function(){n(this).bind(i,n.noop)}}})}(n,this)}),function(){"use strict";function n(n,t){function i(i,r){function f(){r.removeClass("collapse").addClass("collapsing");t.addClass(r,"in",{to:{height:r[0].scrollHeight+"px"}}).then(e)}function e(){r.removeClass("collapsing");r.css({height:"auto"});n.bind("click",u)}function o(){r.css({height:r[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing");t.removeClass(r,"in",{to:{height:"0"}}).then(s)}function s(){r.css({height:"0"});r.removeClass("collapsing");r.addClass("collapse")}function u(t){if(t&&r){if(r[0].contains(t.target)||angular.element(t.target).parents(".modal").length>0||angular.element(t.target).parents(".preventoutsideclick").length>0)return;i.$apply(function(){i.outsideclick({})});n.unbind("click",u)}}i.$watch("iscollapsed",function(t){t?(n.unbind("click",u),o()):f()})}return{link:i,scope:{outsideclick:"&",iscollapsed:"="},restrict:"A"}}angular.module("sats.collapse-autoclose").directive("satsCollapseAutoClose",n);n.$inject=["$document","$animate"]}(),function(){"use strict";function t(){function t(){}return{link:t,controller:n,controllerAs:"vm",bindToController:!0,restrict:"EA",templateUrl:satsSettings.basePath+"NgTemplates/sats.cookie-notice"}}function n(n){function i(){var i=n.get("acceptedCookies");i==="true"||isEmbededInApp()?t.showCookieNotice=!1:pushMenu(!0)}function r(){t.showCookieNotice=!1;u()}function u(){var t=new Date;t.setDate(t.getDate()+30);pushMenu(!1);n.put("acceptedCookies","true",{expires:t,path:"/"})}var t=this;t.showCookieNotice=!0;t.closeCookieNotice=r;t.cookieNotice=satsSettings.cookieNoticeText.cookieNotice;t.buttonClose=satsSettings.cookieNoticeText.buttonClose;t.buttonReadMore=satsSettings.cookieNoticeText.buttonReadMore;t.buttonUrl=satsSettings.cookieNoticeReadMoreUrl;i()}angular.module("sats.cookie-notice",["ngSanitize"]).directive("satsCookieNotice",t);n.$inject=["$cookies"]}(),function(){"use strict";angular.module("sats.drag-select")}(),function(){"use strict";function t(){function t(){}return{link:t,controller:n,controllerAs:"vm",bindToController:!0,scope:{onselectend:"&"},restrict:"A"}}function n(n,t,i,r,u,f){function w(){r.on("mouseup","body",o(y));r.on("touchend","body",o(y));r.on("touchmove","body",o(d))}function b(n){var t=angular.element(n.Element);t.on("mouseenter",o(k));t.on("mousedown",o(p));t.on("touchstart",o(p));e.items.push(n)}function y(n,t){if(s){s=!1;h=[];e.onselectend({});t.preventDefault();t.stopPropagation()}}function p(t,i){s=!0;h=n.map(e.items,function(n){return{Row:n.Row,Column:n.Column,Selected:n.Model[n.Selected]}});v=t;var r=n.find(e.items,function(n){return angular.element(n.Element).is(t)});c=!r.Model[r.Selected];l(t);i.preventDefault()}function k(n,t){s&&(l(n),t.preventDefault())}function d(n,t){if(s){var n=r[0].elementFromPoint(t.originalEvent.targetTouches[0].clientX,t.originalEvent.targetTouches[0].clientY);l(n);t.preventDefault()}}function l(t){for(var o=g(v,t),r=0;r<e.items.length;r++){var i=e.items[r],f=h[r],u=n.findWhere(o,{Column:i.Column,Row:i.Row});if(u!=undefined){u.Model[u.Selected]==!c&&i.OnSelect({state:c});continue}i.Model[i.Selected]!=f.Selected&&i.OnSelect({state:f.Selected})}}function g(t,i){var r=a(t),u=a(i),f=r.row<u.row||r.row==u.row&&r.column<u.column?r:u,o=f==r?u:r;return n.filter(e.items,function(n){var i=angular.element(n.Element),t=a(i);return!t.filler&&(t.row!=f.row||t.column>=f.column)&&(t.row!=o.row||t.column<=o.column)&&t.row>=f.row&&t.row<=o.row})}function a(t){var r=angular.element(t),i=n.find(e.items,function(n){return angular.element(n.Element).is(r)});if(i!=undefined)return{column:i.Column,row:i.Row,filler:i.Filler}}function o(n){return function(t){var i=angular.element(this);f.$apply(function(){n(i,t)})}}var e=this;e.items=[];e.addItem=b;w();var v=null,s=!1,h=[],c=!0}angular.module("sats.drag-select").directive("satsDragSelect",t);n.$inject=["_","Math","$element","$document","$window","$scope"]}(),function(){"use strict";function n(){function n(n,t,i,r){r.addItem({Element:t[0],Row:n.row,Column:n.column,Filler:n.filler,Selected:n.selected,Model:n.model,OnSelect:n.onselect})}return{link:n,require:"^satsDragSelect",scope:{row:"=",column:"=",filler:"=",selected:"@",model:"=",onselect:"&"},restrict:"A"}}angular.module("sats.drag-select-item").directive("satsDragSelectItem",n)}(),function(){"use strict";angular.module("sats.dropdown-datetime")}(),function(){"use strict";function t(){function t(){}return{link:t,controller:n,controllerAs:"vm",bindToController:!0,scope:{placeholder:"=placeholder",timeitems:"=timeitems",weeks:"=weeks",isAlwaysOpen:"@isAlwaysOpen"},templateUrl:satsSettings.basePath+"NgTemplates/sats.dropdown-datetime",restrict:"E"}}function n(n,t,i,r,u){function e(){var i=f.weeks.getFlat(),t=n.filter(i,function(n){return n.Checked});f.placeholder=t.length>0?satsSettings.booking.filterDaysChosen.replace("{nr}",t.length):satsSettings.booking.addDateTime}function s(){this.weeks.clearAll();e();f.isAlwaysOpen&&u.$broadcast("close-modal-event")}function h(){this.weeks.chooseAll();e()}function c(){var r,u,i,o;if(f.isAlwaysOpen)e(),o=$(window).height(),$(".mobile-modal").height($(window).height()),$(".boxWrap").css({height:o-125+"px"}),$(".dropdown-menu").height($(window).height()-76);else{for(f.weekdayLabels=[],i=1;i<8;i++)r=t().day(i).format("dd"),f.weekdayLabels.push(r.charAt(0).toUpperCase()+r.slice(1));for(u=n.filter(f.weeks.getFlat(),function(n){return n.Past===!1}),i=0;i<8;i++)f.weeks.check(u[i],!0)}}function l(n){f.filterBtnTxt=satsSettings.booking.closeFilterButtonClose;$("input.form-control").blur();n.preventDefault();n.stopPropagation();f.status.isopen=!f.status.isopen}function a(n){f.isAlwaysOpen?u.$broadcast("close-modal-event"):f.toggleDropdown(n);u.$broadcast("clickSearch")}var f=this,o;f.status={isopen:!1};f.toggleDropdown=l;f.filterBtnClick=a;f.filterBtnTxt=satsSettings.booking.closeFilterButtonClose;f.clearTimeFilters=s;f.addAll=h;f.placeholder=satsSettings.booking.filterDaysChosen.replace("{nr}",8);u.$on("clearAllClick",function(){e()});i.$watch("vm.status.isopen",function(n){var t;n||(t=JSON.stringify(f.weeks),o&&t!==o&&u.$broadcast("clickSearch"),o=t)});r.updateSearch.registerCallback(function(){f.filterBtnTxt=satsSettings.booking.closeFilterButtonChoose;e()});c();i.prevDef=function(n){n.preventDefault();n.stopPropagation()}}angular.module("sats.dropdown-datetime").directive("satsDropdownDatetime",t).directive("basicClick",["$parse",function(n){return{compile:function(t,i){var r=n(i.basicClick);return function(n,t){t.on("click",function(t){r(n,{$event:t});n.$apply()})}}}}]);n.$inject=["_","moment","$scope","bookingDataService","$rootScope"]}(),function(){"use strict";angular.module("sats.dropdown-filter")}(),function(){"use strict";function t(){function t(){}return{link:t,controller:n,controllerAs:"vm",bindToController:!0,scope:{placeholder:"@placeholder",items:"=items",limit:"@",isAlwaysOpen:"@isAlwaysOpen",minQueryLength:"@"},templateUrl:satsSettings.basePath+"NgTemplates/sats.dropdown-filter",restrict:"E"}}function n(n,t,i,r,u){function s(){if(f.status={isopen:!1},f.isAlwaysOpen){var n=$(window).height();$(".mobile-modal").height($(window).height());$(".boxWrap").css({height:n-125+"px"});$(".dropdown-menu").height($(window).height()-76)}}function h(n){f.filterBtnTxt=satsSettings.booking.closeFilterButtonClose;n.preventDefault();n.stopPropagation();f.status.isopen?n.currentTarget.blur():n.currentTarget.focus();f.status.isopen=!f.status.isopen}function o(n,t){var r,i;for(f.status.isopen=t==undefined?!0:!!t,r=f.query.length>0,i=0;i<n.length;i++)n[i].isOpen=r,r||(n[i].isAllSubItemsFiltered=!1)}function c(n,t){var e,i,r,u,t;if(f.query.length==0)return!0;if(e=new RegExp(f.query.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),i=n.Label.search(e)>=0,n.SubItems){for(r=!0,u=0;u<n.SubItems.length;u++)t=n.SubItems[u].Label.search(e),i=i||t>=0,r=r&&t==-1;n.isAllSubItemsFiltered=r}return i}function l(n){if(f.query.length==0)return!0;var t=new RegExp(f.query.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");return n.Label.search(t)>=0}function a(n){f.toggleDropdown(n);f.isAlwaysOpen&&u.$broadcast("close-modal-event");u.$broadcast("clickSearch")}var f=this,e;f.query="";f.toggleDropdown=h;f.status=null;f.queryChanged=o;f.blur=blur;f.filterCategory=c;f.filterItem=l;f.limit=f.limit==undefined||f.limit==""?Infinity:f.limit;f.minQueryLength=f.minQueryLength||0;f.filterBtnClick=a;f.filterBtnTxt=satsSettings.booking.closeFilterButtonClose;f.typeAtLeastMessage=satsSettings.booking.typeAtLeast.replace("{nr}",f.minQueryLength);u.$on("filterButtonTxt",function(n,t){t=="choose"&&(f.filterBtnTxt=satsSettings.booking.closeFilterButtonChoose);t=="close"&&(f.filterBtnTxt=satsSettings.booking.closeFilterButtonClose)});s();n.$watch("vm.status.isopen",function(n){var t;n||(f.query="",o(f.items,!1),t=JSON.stringify(f.items),e&&t!==e&&u.$broadcast("clickSearch"),e=t)})}angular.module("sats.dropdown-filter").directive("satsDropdownFilter",t);n.$inject=["$scope","$filter","_","bookingDataService","$rootScope"]}(),function(){"use strict";function n(n){function t(t,i,r){var u=function(){var i=n.open({animation:!0,templateUrl:satsSettings.basePath+"NgTemplates/loginModal",controller:"loginModalController",size:"md",controllerAs:"vm"});i.result.then(function(n){if(n=="finished"&&t.callback){var i="";try{i=angular.fromJson(r.callbackData)}catch(u){i=r.callbackData}t.callback({data:i})}})};i.bind("click",function(){u()});r.triggerOnLoad=="true"&&u()}return{link:t,restrict:"EA",scope:{callback:"&"}}}angular.module("sats.open-login-modal").directive("openLoginModal",n);n.$inject=["$modal","$parse"]}(),function(){"use strict";function n(n,i){var r=window.innerHeight-i.getBoundingClientRect().top;r>0?(t.setAttribute("sticky-footer","absolute"),n.css("bottom",i.offsetHeight+"px")):t.setAttribute("sticky-footer","fixed")}var t=document.body;angular.module("sats.sticky-footer").directive("stickyFooter",function(){return{restrict:"A",scope:{stickyFooter:"@"},link:function(t,i){var r=document.querySelector(t.stickyFooter);n(i,r);window.addEventListener("scroll",function(){n(i,r)});window.addEventListener("resize",function(){n(i,r)});r.style.marginTop=i.prop("offsetHeight")+"px"}}})}(),function(){"use strict";angular.module("sats.video-modal").controller("imageAndVideoController",["$scope","ngNotify","querystring",function(n,t,i){n.showMessage=function(n){t.set(n,"error")};n.loginAndWatchMovie=function(n){var t=i.media?window.location.href:window.location.href+"?media="+n;window.location.href=t};n.init=function(t){i.media&&n.showMessage(t)}}]).directive("videoModal",["$modal","querystring",function(n,t){var i=function(t,i,r,u){u&&ga("send","event","online-training",u,satsSettings.userid);n.open({animation:!0,backdropClass:"video-backdrop",windowClass:"video-modal",templateUrl:satsSettings.basePath+"NgTemplates/videoModal",controller:"videoModalController",size:"md",controllerAs:"vm",scope:t,resolve:{item:function(){return{embed:i,videoUrl:r}}}})};return{link:function(n,r,u){var f=t.media;f&&u.mediaId==f&&i(n,u.embedCode,null,u.videoName);(u.embedCode||u.videoUrl)&&r.bind("click",function(){i(n,u.embedCode,u.videoUrl,u.videoName)})}}}]).controller("videoModalController",["$scope","$modalInstance","item","$sce",function(n,t,i,r){var u=this;u.item=i;u.cancel=function(){t.dismiss("cancel")};u.item.embed?n.embed=r.trustAsHtml(u.item.embed):n.videoUrl=r.trustAsResourceUrl(u.item.videoUrl)}])}(),function(){"use strict";var n=angular.module("app.service",[]);n.service("trackingService",[function(){return{pushToDataLayer:function(n){window.dataLayer=window.dataLayer||[];window.dataLayer.push(n)}}}])}()